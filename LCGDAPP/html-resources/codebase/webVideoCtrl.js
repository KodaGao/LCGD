!function(){if(!window.WebVideoCtrl){var e=function(){var e="100%",n="100%",r="",s="";oSecurityCap={};var o={szversion:"websdk3.220200429",szContainerID:szAESKey="",szColorProperty:"",szOcxClassId:"clsid:FDF0038A-CF64-4634-81AB-80F0A7946D6C",szMimeTypes:"application/webvideo-plugin-kit",szBasePath:"",iWndowType:1,iPlayMode:2,bWndFull:!0,iPackageType:2,bDebugMode:!1,bNoPlugin:!0,cbSelWnd:null,cbDoubleClickWnd:null,cbEvent:null,cbRemoteConfig:null,cbInitPluginComplete:null,proxyAddress:null},a=null,c=0,u=!1,l=[],d=[],p=null,h=null,P=null,f=null,I=this,m=null,S=1,C="IPCamera",y="IPDome",v="IPZoom";window.GetSelectWndInfo=function(e){if(k())c=e,(n=[]).push("<RealPlayInfo>"),n.push("<SelectWnd>"+e+"</SelectWnd>"),n.push("</RealPlayInfo>"),o.cbSelWnd&&o.cbSelWnd(f.loadXML(n.join("")));else{var n,r=f.loadXML(e);if(0<t.$XML(r).find("SelectWnd",!0).length)c=parseInt(t.$XML(r).find("SelectWnd").eq(0).text(),10),null===m&&L(),(n=[]).push("<RealPlayInfo>"),n.push("<SelectWnd>"+c+"</SelectWnd>"),n.push("</RealPlayInfo>"),o.cbSelWnd&&o.cbSelWnd(f.loadXML(n.join("")));else if(0<t.$XML(r).find("DoubleClickWnd",!0).length){var s=parseInt(t.$XML(r).find("DoubleClickWnd").eq(0).text(),10);u="0"===t.$XML(r).find("IsFullScreen").eq(0).text(),o.cbDoubleClickWnd&&o.cbDoubleClickWnd(s,u)}}},window.WindowDblClick=function(e){u=e,o.cbDoubleClickWnd&&o.cbDoubleClickWnd(c,u)},window.ZoomInfoCallback=function(e){var t=I.findWndIndexByIndex(c);if(-1!=t){var n=d[t];if(-1!=(t=I.findDeviceIndexByIP(n.szDeviceIdentify))){var r=l[t];r.oProtocolInc.set3DZoom(r,n,e,{success:function(e){},error:function(){}})}}},window.PluginEventHandler=function(e,t,n){k()?o.cbEvent&&o.cbEvent(e,t,n):(0==t||2==t?I.I_Stop(e):21==t?I.I_StopRecord(e):3==t&&I.I_StopVoiceTalk(),o.cbEvent&&o.cbEvent(t,e,n))},window.GetHttpInfo=function(e,t,n){O.prototype.processCallback(e,t)},window.RemoteConfigInfo=function(e){o.cbRemoteConfig&&o.cbRemoteConfig(e)},window.KeyBoardEventInfo=function(e){100===parseInt(e,10)&&(u=!1,o.cbDoubleClickWnd&&o.cbDoubleClickWnd(c,u))};var g=function(){if(o.bDebugMode){var e=x(arguments);p._alert(e)}},x=function(){for(var e=arguments[0],t=1;t<arguments.length;t++)e=e.replace("%s",arguments[t]);return e},D=function(e){var t=e.indexOf(":");return-1<t?e.substring(0,t):e},z=function(e){return void 0===e},T=function(e){return"[object Object]"===Object.prototype.toString.call(e)},b=function(e,t){var n="",r={type:"GET",async:!1,success:function(e){e&&e.Token&&(n=e.Token.value)}};return I.I_SendHTTPRequest(t,"ISAPI/Security/token?format=json",r),n},A=function(e,n,r){I.I_GetSecurityVersion(e,{success:function(e){oSecurityCap.iKeyIterateNum=parseInt(t.$XML(e).find("keyIterateNum").eq(0).text(),10),oSecurityCap.oIrreversibleEncrypt={bSupport:"true"===t.$XML(e).find("isIrreversible").eq(0).text(),salt:t.$XML(e).find("salt").eq(0).text()},szAESKey=f.strToAESKey(n,r)}})},M=function(){var t="";if(f.browser().msie)t="<object classid='"+o.szOcxClassId+"' codebase='' standby='Waiting...' id='"+r+"' width='"+e+"' height='"+n+"' align='center' ><param name='wndtype' value='"+o.iWndowType+"'><param name='playmode' value='"+o.iPlayMode+"'><param name='colors' value='"+o.szColorProperty+"'></object>";else for(var i=navigator.mimeTypes.length,a=0;a<i;a++)navigator.mimeTypes[a].type.toLowerCase()==o.szMimeTypes&&(t="<embed align='center' type='"+o.szMimeTypes+"' width='"+e+"' height='"+n+"' name='"+s+"' wndtype='"+o.iWndowType+"' playmode='"+o.iPlayMode+"' colors='"+o.szColorProperty+"'>");return t},L=function(){if(!k()&&null!==a){var e=a.HWP_GetLocalConfig();m=f.loadXML(e)}},q=function(e){I.I_GetDeviceInfo(e.szIP,{success:function(n){e.szDeviceType=t.$XML(n).find("deviceType").eq(0).text()}}),I.I_GetAnalogChannelInfo(e.szIP,{success:function(e){},error:function(){}}),I.I_GetAudioInfo(e.szIP,{success:function(n){var r=t.$XML(n).find("audioCompressionType",!0);if(0<r.length){var s=t.$XML(r).eq(0).text(),o=0;"G.711ulaw"==s?o=1:"G.711alaw"==s?o=2:"G.726"==s?o=3:"MP2L2"==s||"MPEL2"==s?o=4:"G.722.1"==s?o=0:"AAC"==s?o=5:"PCM"==s&&(o=6),e.iAudioType=o}""!==t.$XML(n).find("audioBitRate").eq(0).text()?e.m_iAudioBitRate=1e3*parseInt(t.$XML(n).find("audioBitRate").eq(0).text(),10):e.m_iAudioBitRate=0,""!==t.$XML(n).find("audioSamplingRate").eq(0).text()?e.m_iAudioSamplingRate=1e3*parseInt(t.$XML(n).find("audioSamplingRate").eq(0).text(),10):e.m_iAudioSamplingRate=0}})},R=function(e){e.bSupportWebsocket=!1,e.bSupportSubStreamPlayback=!1,e.oProtocolInc.getSystemCapa(e,{success:function(n){var r=t.$XML(n).find("NetworkCap").eq(0).find("isSupportWebsocket",!0);0<r.length&&(e.bSupportWebsocket="true"===t.$XML(n).find("NetworkCap").eq(0).find("isSupportWebsocket").eq(0).text()),e.bSupportWebsocket=!0,0<(r=t.$XML(n).find("RacmCap").eq(0).find("isSupportMainAndSubRecord",!0)).length&&(e.bSupportSubStreamPlayback="true"===t.$XML(n).find("RacmCap").eq(0).find("isSupportMainAndSubRecord").eq(0).text()),e.bSupportSubStreamPlayback=!0}})},w=function(e){var t=null;if(_(e))(t=G(e)).iRtspPort,t.iDevicePort;else{for(var n=X(e),r=!1,s=0;s<n.length;s++)if(n[s].ipv4==e.szIP||n[s].ipv6==e.szIP){r=!0;break}(r||-1==(t=W(e)).iRtspPort&&-1==t.iDevicePort)&&(t=G(e)),t.iRtspPort,t.iHttpPort,t.iDevicePort}return t},G=function(e){var n=-1,r=-1,s=-1;return e.oProtocolInc.getPortInfo(e,{async:!1,success:function(e){var o=t.$XML(e).find("AdminAccessProtocol",!0);n=554;for(var i=0,a=o.length;i<a;i++)"rtsp"===t.$XML(o).eq(i).find("protocol").eq(0).text().toLowerCase()&&(n=parseInt(t.$XML(o).eq(i).find("portNo").eq(0).text(),10)),"http"===t.$XML(o).eq(i).find("protocol").eq(0).text().toLowerCase()&&(r=parseInt(t.$XML(o).eq(i).find("portNo").eq(0).text(),10)),"dev_manage"===t.$XML(o).eq(i).find("protocol").eq(0).text().toLowerCase()&&(s=parseInt(t.$XML(o).eq(i).find("portNo").eq(0).text(),10))},error:function(){s=r=n=-1}}),{iRtspPort:n,iHttpPort:r,iDevicePort:s}},W=function(e){var n=-1,r=-1,s=-1;return e.oProtocolInc.getUPnPPortStatus(e,{async:!1,success:function(e){for(var o=t.$XML(e).find("portStatus",!0),i=0,a=o.length;i<a;i++)"rtsp"==t.$XML(o).eq(i).find("internalPort").eq(0).text().toLowerCase()&&(n=parseInt(t.$XML(o).eq(i).find("externalPort").eq(0).text(),10)),"http"==t.$XML(o).eq(i).find("internalPort").eq(0).text().toLowerCase()&&(r=parseInt(t.$XML(o).eq(i).find("externalPort").eq(0).text(),10)),"admin"==t.$XML(o).eq(i).find("internalPort").eq(0).text().toLowerCase()&&(s=parseInt(t.$XML(o).eq(i).find("externalPort").eq(0).text(),10))},error:function(){s=r=n=-1}}),{iRtspPort:n,iHttpPort:r,iDevicePort:s}},X=function(e){var n=[];return e.oProtocolInc.getNetworkBond(e,{async:!1,success:function(r){"true"==t.$XML(r).find("enabled").eq(0).text()?n.push({ipv4:t.$XML(r).find("ipAddress").eq(0).text(),ipv6:t.$XML(r).find("ipv6Address").eq(0).text()}):e.oProtocolInc.getNetworkInterface(e,{async:!1,success:function(e){for(var r=0,s=t.$XML(e).find("NetworkInterface",!0).length;r<s;r++){n.push({ipv4:t.$XML(e).find("ipAddress").eq(0).text(),ipv6:t.$XML(e).find("ipv6Address").eq(0).text()});break}},error:function(){}})},error:function(){e.oProtocolInc.getNetworkInterface(e,{async:!1,success:function(e){for(var r=0,s=t.$XML(e).find("NetworkInterface",!0).length;r<s;r++){n.push({ipv4:t.$XML(e).find("ipAddress").eq(0).text(),ipv6:t.$XML(e).find("ipv6Address").eq(0).text()});break}},error:function(){}})}}),n},_=function(e){var n=!1;return e.oProtocolInc.getPPPoEStatus(e,{async:!1,success:function(e){n=0<t.$XML(e).find("ipAddress",!0).length||0<t.$XML(e).find("ipv6Address",!0).length},error:function(){n=!1}}),n},H=function(e){e.oProtocolInc instanceof J&&e.oProtocolInc.getSDKCapa(e,{async:!1,success:function(n){e.oStreamCapa.bObtained=!0,e.oStreamCapa.bSupportShttpPlay="true"===t.$XML(n).find("isSupportHttpPlay").eq(0).text(),e.oStreamCapa.bSupportShttpPlayback="true"===t.$XML(n).find("isSupportHttpPlayback").eq(0).text(),e.oStreamCapa.bSupportShttpsPlay="true"===t.$XML(n).find("isSupportHttpsPlay").eq(0).text(),e.oStreamCapa.bSupportShttpsPlayback="true"===t.$XML(n).find("isSupportHttpsPlayback").eq(0).text(),e.oStreamCapa.bSupportShttpPlaybackTransCode="true"===t.$XML(n).find("isSupportHttpTransCodePlayback").eq(0).text(),e.oStreamCapa.bSupportShttpsPlaybackTransCode="true"===t.$XML(n).find("isSupportHttpsTransCodePlayback").eq(0).text(),0<t.$XML(n).find("ipChanBase",!0).length?e.oStreamCapa.iIpChanBase=parseInt(t.$XML(n).find("ipChanBase").eq(0).text(),10):e.oStreamCapa.iIpChanBase=1},error:function(){e.oStreamCapa.bObtained=!0}})},k=function(){if(o.bNoPlugin){var e=f.browser();return!!(e.chrome&&45<parseInt(e.version,10)||e.mozilla&&52<parseInt(e.version,10))}return!1},E=function(e){var t=location.hostname,n=location.port||"80";return o.proxyAddress&&(t=o.proxyAddress.ip,n=o.proxyAddress.port),/^(http|https):\/\/([^\/]+)(.+)$/.test(e)&&(e=e.replace(RegExp.$2,t+":"+n)),f.cookie("webVideoCtrlProxy",RegExp.$2,{raw:!0}),e},Z=function(){return f.loadXML("<ResponseStatus><requestURL></requestURL><statusCode>4</statusCode><statusString>Invalid Operation</statusString><subStatusCode>notSupport</subStatusCode></ResponseStatus>")};this.I_SupportNoPlugin=function(){return k()},this.I_DestroyWorker=function(){null!==a&&k()&&a.JS_DestroyWorker()},this.I_Resize=function(t,r){null!==a&&k()&&(e=t,n=r,a.JS_Resize(t,r))},this.I_InitPlugin=function(t,r,s){if(e=t,n=r,f.extend(o,s),k()){var i=f.getDirName();i&&("object"==typeof exports&&"undefined"!=typeof module||("function"==typeof define&&define.amd?require([i+"/jsPlugin-1.2.0.min.js"],(function(e){window.JSPlugin=e.JSPlugin,s.cbInitPluginComplete&&s.cbInitPluginComplete()})):f.loadScript(i+"/jsPlugin-1.2.0.min.js",(function(){s.cbInitPluginComplete&&s.cbInitPluginComplete()})))),z(document.fullScreen)?z(document.webkitIsFullScreen)?z(document.mozFullScreen)||document.addEventListener("mozfullscreenchange",(function(e){var t=document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||!1;u&&!t&&window.KeyBoardEventInfo(100)})):document.addEventListener("webkitfullscreenchange",(function(e){var t=document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||!1;u&&!t&&window.KeyBoardEventInfo(100)})):document.addEventListener("fullscreenchange",(function(e){var t=document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||!1;u&&!t&&window.KeyBoardEventInfo(100)})),window.addEventListener("unload",(function(){null!==a&&a.JS_DestroyWorker()}))}else s.cbInitPluginComplete&&s.cbInitPluginComplete()},this.I_InsertOBJECTPlugin=function(t){if(z(t)||(o.szContainerID=t),null==document.getElementById(o.szContainerID))return-1;if(null!=document.getElementById(r)||0!=document.getElementsByName(r).length)return-1;if(k()){var i={szId:t,iType:1,iWidth:e,iHeight:n,iMaxSplit:4,iCurrentSplit:o.iWndowType,szBasePath:f.getDirName()},c=o.szColorProperty;if(""!=c){for(var u={},l=c.split(";"),d="",p=0,h=l.length;p<h;p++)-1<(d=l[p]).indexOf("sub-background")?u.background="#"+d.split(":")[1]:-1<d.indexOf("sub-border-select")?u.borderSelect="#"+d.split(":")[1]:-1<d.indexOf("sub-border")&&(u.border="#"+d.split(":")[1]);i.oStyle=u}a=new JSPlugin(i)}else document.getElementById(o.szContainerID).innerHTML=M(),a=f.browser().msie?document.getElementById(r):document.getElementsByName(s)[0];return null==a&&null==a.object?-1:("object"==typeof window.attachEvent&&f.browser().msie&&(a.attachEvent("GetSelectWndInfo",GetSelectWndInfo),a.attachEvent("ZoomInfoCallback",ZoomInfoCallback),a.attachEvent("GetHttpInfo",GetHttpInfo),a.attachEvent("PluginEventHandler",PluginEventHandler),a.attachEvent("RemoteConfigInfo",RemoteConfigInfo),a.attachEvent("KeyBoardEventInfo",KeyBoardEventInfo)),L(),0)},this.I_WriteOBJECT_XHTML=function(){return k()?-1:(document.writeln(M()),null==(a=f.browser().msie?document.getElementById(r):document.getElementsByName(s)[0])&&null==a.object?-1:("object"==typeof window.attachEvent&&f.browser().msie&&(a.attachEvent("GetSelectWndInfo",GetSelectWndInfo),a.attachEvent("ZoomInfoCallback",ZoomInfoCallback),a.attachEvent("GetHttpInfo",GetHttpInfo),a.attachEvent("PluginEventHandler",PluginEventHandler),a.attachEvent("RemoteConfigInfo",RemoteConfigInfo),a.attachEvent("KeyBoardEventInfo",KeyBoardEventInfo)),L(),0))},this.I_OpenFileDlg=function(e){var t="";if(k())return t;if(null==(t=a.HWP_OpenFileBrowser(e,"")))return"";if(1==e){if(100<t.length)return-1}else if(130<t.length)return-1;return t},this.I2_OpenFileDlg=function(e){var t="",n=$.Deferred();return k()?a.JS_OpenFileBrowser(e,"").then((function(t){null!=t?1==e?100<t.length&&n.resolve(-1):130<t.length&&n.resolve(-1):n.resolve(),n.resolve(t)})):(null!=(t=a.HWP_OpenFileBrowser(e,""))?1==e?100<t.length&&n.resolve(-1):130<t.length&&n.resolve(-1):n.resolve(),n.resolve(t)),n},this.I_GetLocalCfg=function(){var e=null;if(k())return e;var n=a.HWP_GetLocalConfig(),r=[];return m=f.loadXML(n),r.push("<LocalConfigInfo>"),r.push("<ProtocolType>"+t.$XML(m).find("ProtocolType").eq(0).text()+"</ProtocolType>"),r.push("<PackgeSize>"+t.$XML(m).find("PackgeSize").eq(0).text()+"</PackgeSize>"),r.push("<PlayWndType>"+t.$XML(m).find("PlayWndType").eq(0).text()+"</PlayWndType>"),r.push("<BuffNumberType>"+t.$XML(m).find("BuffNumberType").eq(0).text()+"</BuffNumberType>"),r.push("<RecordPath>"+t.$XML(m).find("RecordPath").eq(0).text()+"</RecordPath>"),r.push("<CapturePath>"+t.$XML(m).find("CapturePath").eq(0).text()+"</CapturePath>"),r.push("<PlaybackFilePath>"+t.$XML(m).find("PlaybackFilePath").eq(0).text()+"</PlaybackFilePath>"),r.push("<PlaybackPicPath>"+t.$XML(m).find("PlaybackPicPath").eq(0).text()+"</PlaybackPicPath>"),r.push("<DeviceCapturePath>"+t.$XML(m).find("DeviceCapturePath").eq(0).text()+"</DeviceCapturePath>"),r.push("<DownloadPath>"+t.$XML(m).find("DownloadPath").eq(0).text()+"</DownloadPath>"),r.push("<IVSMode>"+t.$XML(m).find("IVSMode").eq(0).text()+"</IVSMode>"),r.push("<CaptureFileFormat>"+t.$XML(m).find("CaptureFileFormat").eq(0).text()+"</CaptureFileFormat>"),r.push("</LocalConfigInfo>"),f.loadXML(r.join(""))},this.I_SetLocalCfg=function(e){if(k())return-1;var n=f.loadXML(e);return t.$XML(m).find("ProtocolType").eq(0).text(t.$XML(n).find("ProtocolType").eq(0).text()),t.$XML(m).find("PackgeSize").eq(0).text(t.$XML(n).find("PackgeSize").eq(0).text()),t.$XML(m).find("PlayWndType").eq(0).text(t.$XML(n).find("PlayWndType").eq(0).text()),t.$XML(m).find("BuffNumberType").eq(0).text(t.$XML(n).find("BuffNumberType").eq(0).text()),t.$XML(m).find("RecordPath").eq(0).text(t.$XML(n).find("RecordPath").eq(0).text()),t.$XML(m).find("CapturePath").eq(0).text(t.$XML(n).find("CapturePath").eq(0).text()),t.$XML(m).find("PlaybackFilePath").eq(0).text(t.$XML(n).find("PlaybackFilePath").eq(0).text()),t.$XML(m).find("DeviceCapturePath").eq(0).text(t.$XML(n).find("DeviceCapturePath").eq(0).text()),t.$XML(m).find("PlaybackPicPath").eq(0).text(t.$XML(n).find("PlaybackPicPath").eq(0).text()),t.$XML(m).find("DownloadPath").eq(0).text(t.$XML(n).find("DownloadPath").eq(0).text()),t.$XML(m).find("IVSMode").eq(0).text(t.$XML(n).find("IVSMode").eq(0).text()),t.$XML(m).find("CaptureFileFormat").eq(0).text(t.$XML(n).find("CaptureFileFormat").eq(0).text()),a.HWP_SetLocalConfig(f.toXMLStr(m))?0:-1};var B=function(e,t,n,r,s,i,c){var u={protocol:t,success:null,error:null};f.extend(u,c),f.extend(u,{success:function(u){var d,p=new U;p.szIP=e,2==t?(p.szHttpProtocol="https://",p.iHttpsPort=n):(p.szHttpProtocol="http://",p.iHttpPort=n),p.iCGIPort=n,p.szDeviceIdentify=e+"_"+n,p.szAuth=r,p.iDeviceProtocol=s,p.oProtocolInc=i,g("\u4f7f\u7528%s\u534f\u8bae\u767b\u5f55\u6210\u529f",s),q(p),d=o.bWndFull?1:0,a.HWP_SetCanFullScreen(d),a.HWP_SetPackageType(o.iPackageType),R(p),l.push(jQuery.extend({},p)),c.success&&c.success(u)},error:function(e,t){c.error&&c.error(e,t)}}),i.login(e,n,r,u)};function N(e,t,n){return(e<<16|t<<8|n).toString(16)}function F(e,t){return(Array(t).join("0")+e).slice(-t)}function V(e){if(e&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){for(var t="#",n=1;n<4;n+=1)t+=e.slice(n,n+1).concat(e.slice(n,n+1));e=t}var r=[];for(n=1;n<7;n+=2)r.push(parseInt("0x"+e.slice(n,n+2)));return"["+r.join(",")+",0.6]"}return e}function U(){if(void 0!==U.unique)return U.unique;this.szIP="",this.szHostName="",this.szAuth="",this.szHttpProtocol="http://",this.iCGIPort=80,this.szDeviceIdentify="",this.iDevicePort=-1,this.iHttpPort=-1,this.iHttpsPort=-1,this.iRtspPort=-1,this.iWSPort=-1,this.iAudioType=1,this.m_iAudioBitRate=-1,this.m_iAudioSamplingRate=-1,this.iDeviceProtocol=S,this.oProtocolInc=null,this.iAnalogChannelNum=0,this.szDeviceType="",this.bVoiceTalk=!1,this.oAuthType={},this.oStreamCapa={bObtained:!1,bSupportShttpPlay:!1,bSupportShttpPlayback:!1,bSupportShttpsPlay:!1,bSupportShttpsPlayback:!1,bSupportShttpPlaybackTransCode:!1,bSupportShttpsPlaybackTransCode:!1,iIpChanBase:1},U.unique=this}this.getAuthType=function(e,n,r,s,o,i){e.oAuthType[n]=1;var a={async:!0,success:function(r){e.oAuthType[n]=t.$XML(r).find("sessionIDVersion").eq(0).text(),i()},error:function(t){500<t&&(e.oAuthType[n]=t),i(t)}};h.getSessionCap(n,r,s,o,a)},this.setDeviceInfo=function(e,t,n,r,s){return(t=new U).szIP=n,2==r?(t.szHttpProtocol="https://",t.iHttpsPort=s):(t.szHttpProtocol="http://",t.iHttpPort=s),t.iCGIPort=s,t.szDeviceIdentify=n+"_"+s,t.iDeviceProtocol=S,t.oProtocolInc=e,t},this.successV1cb=function(e,n,r,s,o,i,a,c){(n=this.setDeviceInfo(e,n,r,s,o)).szAuth=t.$XML(i).find("sessionID").eq(0).text();var u=jQuery.extend({},n);l.push(u),q(n),g("\u4f7f\u7528%s\u534f\u8bae\u767b\u5f55\u6210\u529f",S),A(n.szDeviceIdentify,a,c),n.sessionFailed=0,R(n),u.sesstionTimer=setInterval((function(){e.sessionHeartbeat(u,(function(){u.sessionFailed=0}),(function(){u.sessionFailed++,5<=u.sessionFailed&&(window.PluginEventHandler(null,-1,u.szDeviceIdentify),clearInterval(u.sesstionTimer))}))}),3e4)},this.successV2cb=function(e,t,n,r,s,o,i,a){(t=this.setDeviceInfo(e,t,n,r,s)).szAuth=b(0,t.szDeviceIdentify),q(t),g("\u4f7f\u7528%s\u534f\u8bae\u767b\u5f55\u6210\u529f",S),document.cookie="domain='10.18.99.194';path=/;",R(t),A(t.szDeviceIdentify,i,a),t.sessionFailed=0;var c=jQuery.extend({},t);l.push(c),c.sesstionTimer=setInterval((function(){e.sessionHeartbeat(c,(function(){c.sessionFailed=0}),(function(){c.sessionFailed++,5<=c.sessionFailed&&(window.PluginEventHandler(null,-1,c.szDeviceIdentify),clearInterval(c.sesstionTimer))}))}),3e4)},this.I_LoginV1=function(e,t,n,r,s,o,i,a){var c=this,u={success:null,error:null};return f.extend(u,{success:function(u){var l={success:null,error:null};f.extend(l,{success:function(u){a.success&&(a.success(u),c.successV1cb(e,t,n,r,s,u,i,o))},error:function(e,t){a.error&&a.error(e,t)}}),e.sessionLogin(n,r,s,o,i,u,l)},error:function(e,t){a.error&&a.error(e,t)}}),u},this.I_LoginV2=function(e,t,n,r,s,o,i,a,c){var u={success:null,error:null},l=this;return f.extend(u,{success:function(u){var d={success:null,error:null};f.extend(d,{success:function(e){l.successV2cb(t,n,r,s,o,e,a,i),c.success&&c.success(e)},error:function(e,t){c.error&&c.error(e,t)}}),t.sessionV2Login(e,r,s,o,i,a,u,d)},error:function(e,t){c.error&&c.error(e,t)}}),u},this.I_Login=function(e,t,n,r,s,o){var i=e+"_"+n;if(-1!=this.findDeviceIndexByIP(i))return g("\u8bbe\u5907\u5df2\u7ecf\u767b\u5f55\u8fc7"),-1;var a=h,c=S;if(z(o.cgi)||(c=S==o.cgi?(a=h,S):(a=P,2)),k())if(S==c){var u=new U;this.getAuthType(u,e,t,n,r,(function(){var i=u.oAuthType[e];if(2<i)o.error&&o.error(i);else if(i<2){var c=this.I_LoginV1(a,u,e,t,n,r,s,o);a.getSessionCap(e,t,n,r,c)}else{var l=MD5((new Date).getTime().toString()).substring(0,8);l=parseInt(l.replace("#",""),16).toString().substring(0,8),c=this.I_LoginV2(l,a,u,e,t,n,r,s,o),a.getSessionV2Cap(l,e,t,n,r,c)}}))}else o.error&&o.error(403,Z());else{var l="";if(S==c){l=f.Base64.encode(":"+r+":"+s);var d={success:null,error:null};f.extend(d,o),f.extend(d,{error:function(i,u){l=f.Base64.encode(r+":"+s),c=S,a=h;var d={success:null,error:null};f.extend(d,o),f.extend(d,{error:function(){if(z(o.cgi)){l=f.Base64.encode(":"+r+":"+s),c=2,a=P;var d={success:null,error:null};f.extend(d,o),f.extend(d,{error:function(i,u){l=f.Base64.encode(r+":"+s),c=2,a=P;var d={success:null,error:null};f.extend(d,o),f.extend(d,{error:function(){o.error&&o.error(i,u)}}),B(e,t,n,l,c,a,d)}}),B(e,t,n,l,c,a,d)}else o.error&&o.error(i,u)}}),B(e,t,n,l,c,a,d)}}),B(e,t,n,l,c,a,d)}else l=f.Base64.encode(":"+r+":"+s),c=2,a=P,d={success:null,error:null},f.extend(d,o),f.extend(d,{error:function(i,u){l=f.Base64.encode(r+":"+s),c=2,a=P;var d={success:null,error:null};f.extend(d,o),f.extend(d,{error:function(){o.error&&o.error(i,u)}}),B(e,t,n,l,c,a,d)}}),B(e,t,n,l,c,a,d)}},this.I_Logout=function(e){var t=this.findDeviceIndexByIP(e);if(-1==t)return-1;if(k()){var n=l[t];clearInterval(n.sesstionTimer),n.oProtocolInc.sessionLogout(n,{})}return l.splice(t,1),0},this.I_GetAudioInfo=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1!=n){var r=l[n],s={success:null,error:null};f.extend(s,t),r.oProtocolInc.getAudioInfo(r,s)}},this.I_GetDeviceInfo=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1!=n){var r=l[n],s={success:null,error:null};f.extend(s,t),r.oProtocolInc.getDeviceInfo(r,s)}},this.I_GetAnalogChannelInfo=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1!=n){var r=l[n],s={success:null,error:null};f.extend(s,t),r.oProtocolInc.getAnalogChannelInfo(r,s)}},this.I_GetSecurityVersion=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1!=n){var r=l[n],s={success:null,error:null};f.extend(s,t),r.oProtocolInc.getSecurityVersion(r,s)}},this.I_GetDigitalChannelInfo=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1!=n){var r=l[n],s={success:null,error:null};f.extend(s,t),r.oProtocolInc.getDigitalChannelInfo(r,s)}},this.I_GetZeroChannelInfo=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1!=n){var r=l[n],s={success:null,error:null};f.extend(s,t),r.oProtocolInc.getZeroChannelInfo(r,s)}},this.getStream=function(e,t,n){var r=$.Deferred();return k()&&a.JS_Play(e,t,n).then((function(){addToWndSet(),r.resolve()}),(function(){r.reject()})),r},this.I_StartRealPlay=function(e,n){var r=this.findDeviceIndexByIP(e),s="",o="",i=-1,a=0,u=0,p=!1,h={iWndIndex:c,iStreamType:1,iChannelID:1,bZeroChannel:!1};if(f.extend(h,n),-1!=r){H(l[r]);var P=l[r];if(k()){if(!P.bSupportWebsocket)return void(n.error&&n.error(403,Z()));s=P.oProtocolInc.CGI.startWsRealPlay;var I=location.protocol;o=/^(https)(.*)$/.test(I)?"wss://":"ws://",z(h.iWSPort)?P.iWSPort=7681:P.iWSPort=h.iWSPort,i=P.iWSPort,u=h.iStreamType,a=h.iChannelID<=P.iAnalogChannelNum?h.iChannelID:P.oStreamCapa.iIpChanBase+parseInt(h.iChannelID,10)-P.iAnalogChannelNum-1,p=!0}else i=0==parseInt(t.$XML(m).find("ProtocolType").eq(0).text(),10)&&P.oStreamCapa.bSupportShttpPlay?(g("SHTTP RealPlay"),s=P.oProtocolInc.CGI.startShttpRealPlay,o="http://",u=h.iStreamType-1,a=h.iChannelID<=P.iAnalogChannelNum?h.iChannelID:P.oStreamCapa.iIpChanBase+parseInt(h.iChannelID,10)-P.iAnalogChannelNum-1,p=!0,z(h.iPort)?"https://"==P.szHttpProtocol?(-1==P.iHttpPort&&(P.iHttpPort=w(P).iHttpPort),P.iHttpPort):P.iCGIPort:(P.iHttpPort=h.iPort,h.iPort)):(g("RTSP RealPlay"),s=P.oProtocolInc.CGI.startRealPlay,o="rtsp://",u=h.iStreamType,a=h.iChannelID,z(h.iRtspPort)||(P.iRtspPort=h.iRtspPort),-1==P.iRtspPort&&(P.iRtspPort=w(P).iRtspPort),P.iRtspPort);if(-1==i)return g("\u83b7\u53d6\u7aef\u53e3\u53f7\u5931\u8d25"),void(n.error&&n.error());f.extend(h,{urlProtocol:o,cgi:s,iPort:i,iStreamType:u,iChannelID:a}),r=this.findWndIndexByIndex(h.iWndIndex);var S=this;-1==r&&P.oProtocolInc.startRealPlay(P,h).then((function(){r=S.findWndIndexByIndex(h.iWndIndex),d[r].bShttpIPChannel=p,n.success&&n.success()}),(function(){k()||(P.iRtspPort=-1),n.error&&n.error()}))}else n.error&&n.error()},this.I_CloseWin=function(e){var t=this.findWndIndexByIndex(e);d.splice(t,1)},this.I_Stop=function(e){var t={iWndIndex:c};T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e);var n=this.findWndIndexByIndex(t.iWndIndex);if(-1!=n){var r=d[n];r.bRecord&&(k()||a.HWP_StopSave(r.iIndex)),r.bSound&&(k()||a.HWP_CloseSound()),r.bEZoom&&(k()||a.HWP_DisableZoom(r.iIndex)),k()?a.JS_Stop(t.iWndIndex).then((function(){d.splice(n,1),t.success&&t.success()}),(function(){t.error&&t.error()})):0==a.HWP_Stop(t.iWndIndex)?(d.splice(n,1),t.success&&t.success()):t.error&&t.error()}else t.error&&t.error()},this.I_OpenSound=function(e){e=z(e)?c:e;var t=this.findWndIndexByIndex(e),n=-1;if(-1!=t){var r=d[t];r.bSound||0==(n=k()?a.JS_OpenSound(e):a.HWP_OpenSound(e))&&(r.bSound=!0)}return n},this.I_CloseSound=function(e){e=z(e)?c:e;var t=this.findWndIndexByIndex(e),n=-1;if(-1!=t){var r=d[t];r.bSound&&0==(n=k()?a.JS_CloseSound():a.HWP_CloseSound())&&(r.bSound=!1)}return n},this.I_SetVolume=function(e,t){var n=-1;return e=parseInt(e,10),isNaN(e)||e<0||100<e||(t=z(t)?c:t,-1!=this.findWndIndexByIndex(t)&&(n=k()?(a.JS_SetVolume(t,e),0):a.HWP_SetVolume(t,e))),n},this.I2_CapturePic=function(e,t){var n={iWndIndex:c,bDateDir:!0};T(t)?f.extend(n,t):z(t)||(n.iWndIndex=t);var r=this.findWndIndexByIndex(n.iWndIndex),s=$.Deferred();if(-1!=r)if(k()){var o="JPEG";".jpg"===e.slice(-4).toLowerCase()?e=e.slice(0,-4):".jpeg"===e.slice(-5).toLowerCase()?e=e.slice(0,-5):".bmp"===e.slice(-4).toLowerCase()&&(e=e.slice(0,-4),o="BMP"),a.JS_CapturePicture(n.iWndIndex,e,o).then((function(){s.resolve()}),(function(){s.reject()}))}else".jpg"===e.slice(-4).toLowerCase()?e=e.slice(0,-4):".jpeg"===e.slice(-5).toLowerCase()&&(e=e.slice(0,-5)),0===a.HWP_CapturePicture(n.iWndIndex,e,n.bDateDir)?s.resolve():s.reject();else s.reject();return s},this.I2_CapturePicData=function(e){var t={iWndIndex:c,bDateDir:!0};if(T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e),-1!=this.findWndIndexByIndex(t.iWndIndex)){var n=$.Deferred();k()?a.JS_CapturePictureData(t.iWndIndex).then((function(e){n.resolve(e)}),(function(e){g(e),n.reject()})):n.reject()}else n.reject();return n},this.I_StartRecord=function(e,t){var n={iWndIndex:c,bDateDir:!0};T(t)?f.extend(n,t):z(t)||(n.iWndIndex=t);var r=this.findWndIndexByIndex(n.iWndIndex);if(-1!=r){var s=d[r];s.bRecord?n.error&&n.error():k()?f.browser().chrome?a.JS_StartSave(n.iWndIndex,e).then((function(){s.bRecord=!0,n.success&&n.success()}),(function(){n.error&&n.error()})):n.error&&n.error():0==a.HWP_StartSave(n.iWndIndex,e,n.bDateDir)?(s.bRecord=!0,n.success&&n.success()):n.error&&n.error()}else n.error&&n.error()},this.I_StopRecord=function(e){var t={iWndIndex:c};T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e);var n=this.findWndIndexByIndex(t.iWndIndex);if(-1!=n){var r=d[n];r.bRecord?k()?f.browser().chrome?a.JS_StopSave(t.iWndIndex).then((function(){r.bRecord=!1,t.success&&t.success()}),(function(){t.error&&t.error()})):t.error&&t.error():0==a.HWP_StopSave(t.iWndIndex)?(r.bRecord=!1,t.success&&t.success()):t.error&&t.error():t.error&&t.error()}else t.error&&t.error()},this.I_StartVoiceTalk=function(e,t){if(isNaN(parseInt(t,10)))return-1;var n=this.findDeviceIndexByIP(e),r=-1;if(-1!=n){var s=l[n];s.bVoiceTalk||0==(r=k()?-1:s.oProtocolInc.startVoiceTalk(s,t))&&(l[n].bVoiceTalk=!0)}return r},this.I_StopVoiceTalk=function(){var e=-1;if(!k()){e=a.HWP_StopVoiceTalk();for(var t=0,n=l.length;t<n;t++)if(l[t].bVoiceTalk){l[t].bVoiceTalk=!1;break}}return e},this.I_PTZControl=function(e,t,n){var r={iWndIndex:c,iPTZIndex:e,iPTZSpeed:4};f.extend(r,n),f.extend(r,{async:!1});var s=this.findWndIndexByIndex(r.iWndIndex);if(-1!=s){var o=d[s];if(-1!=(s=this.findDeviceIndexByIP(o.szIP))){var i=l[s];9==e?i.oProtocolInc.ptzAutoControl(i,t,o,r):i.oProtocolInc.ptzControl(i,t,o,r)}}},this.I_EnableEZoom=function(e){e=z(e)?c:e;var t=this.findWndIndexByIndex(e),n=-1;if(-1!=t){var r=d[t];r.bEZoom||0==(n=k()?a.JS_EnableZoom(e):a.HWP_EnableZoom(e,0))&&(r.bEZoom=!0)}return n},this.I_DisableEZoom=function(e){e=z(e)?c:e;var t=this.findWndIndexByIndex(e),n=-1;if(-1!=t){var r=d[t];r.bEZoom&&0==(n=k()?a.JS_DisableZoom(e):(a.HWP_DisableZoom(e),0))&&(r.bEZoom=!1)}return n},this.I_Enable3DZoom=function(e){e=z(e)?c:e;var t=this.findWndIndexByIndex(e),n=-1;if(-1!=t){var r=d[t];r.b3DZoom||(k()?(n=0,a.JS_Enable3DZoom(e,(function(e){window.ZoomInfoCallback(e)}))):n=a.HWP_EnableZoom(e,1),0==n&&(r.b3DZoom=!0))}return n},this.I_Disable3DZoom=function(e){e=z(e)?c:e;var t=this.findWndIndexByIndex(e),n=-1;if(-1!=t){var r=d[t];r.b3DZoom&&0==(k()?a.JS_Disable3DZoom(e):a.HWP_DisableZoom(e),n=0)&&(r.b3DZoom=!1)}return n},this.I_FullScreen=function(e){k()?a.JS_FullScreenSingle(c):a.HWP_FullScreenDisplay(e)},this.I_SetPreset=function(e,t){var n={iWndIndex:c,iPresetID:e};f.extend(n,t);var r=this.findWndIndexByIndex(n.iWndIndex);if(-1!=r){var s=d[r];if(-1!=(r=this.findDeviceIndexByIP(s.szIP))){var o=l[r];o.oProtocolInc.setPreset(o,s,n)}}},this.I_GoPreset=function(e,t){var n={iWndIndex:c,iPresetID:e};f.extend(n,t);var r=this.findWndIndexByIndex(n.iWndIndex);if(-1!=r){var s=d[r];if(-1!=(r=this.findDeviceIndexByIP(s.szIP))){var o=l[r];o.oProtocolInc.goPreset(o,s,n)}}},this.I_RecordSearch=function(e,t,n,r,s){var o=this.findDeviceIndexByIP(e);if(-1!=o){var i=l[o],a={iChannelID:t,szStartTime:n,szEndTime:r,iSearchPos:0,iStreamType:1,success:null,error:null};f.extend(a,s),i.oProtocolInc.recordSearch(i,a)}},this.I_StartPlayback=function(e,n){var r=this.findDeviceIndexByIP(e),s="",o="",i=-1,a=1,u=0,d=f.dateFormat(new Date,"yyyy-MM-dd"),p={iWndIndex:c,iStreamType:1,iChannelID:1,szStartTime:d+" 00:00:00",szEndTime:d+" 23:59:59"};if(f.extend(p,n),-1!=r){H(l[r]);var h=l[r];if(k()){if(!h.bSupportWebsocket)return void(n.error&&n.error(403,Z()));if(!z(p.oTransCodeParam))return void(n.error&&n.error());s=h.oProtocolInc.CGI.startWsPlayback;var P=location.protocol;o=/^(https)(.*)$/.test(P)?"wss://":"ws://",z(p.iWSPort)?h.iWSPort=7681:h.iWSPort=p.iWSPort,i=h.iWSPort,u=p.iStreamType,a=100*(a=p.iChannelID<=h.iAnalogChannelNum?p.iChannelID:h.oStreamCapa.iIpChanBase+parseInt(p.iChannelID,10)-h.iAnalogChannelNum-1)+u}else i=0==parseInt(t.$XML(m).find("ProtocolType").eq(0).text(),10)&&h.oStreamCapa.bSupportShttpPlay?(s=z(p.oTransCodeParam)?h.oProtocolInc.CGI.startShttpPlayback:h.oProtocolInc.CGI.startTransCodePlayback,o="http://",u=p.iStreamType-1,a=p.iChannelID<=h.iAnalogChannelNum?p.iChannelID:h.oStreamCapa.iIpChanBase+parseInt(p.iChannelID,10)-h.iAnalogChannelNum-1,h.bSupportSubStreamPlayback&&(a=100*a+u),z(p.iPort)?"https://"==h.szHttpProtocol?(-1==h.iHttpPort&&(h.iHttpPort=w(h).iHttpPort),h.iHttpPort):h.iCGIPort:(h.iHttpPort=p.iPort,p.iPort)):(s=h.oProtocolInc.CGI.startPlayback,o="rtsp://",u=p.iStreamType,a=100*p.iChannelID+u,z(p.iRtspPort)||(h.iRtspPort=p.iRtspPort),-1==h.iRtspPort&&(h.iRtspPort=w(h).iRtspPort),h.iRtspPort);if(-1==i)return g("\u83b7\u53d6\u7aef\u53e3\u53f7\u5931\u8d25"),void(n.error&&n.error());f.extend(p,{urlProtocol:o,cgi:s,iPort:i,iChannelID:a}),-1==(r=this.findWndIndexByIndex(p.iWndIndex))&&(k()?(p.szStartTime=p.szStartTime.replace(" ","T")+"Z",p.szEndTime=p.szEndTime.replace(" ","T")+"Z",h.oProtocolInc.startPlayback(h,p).then((function(){n.success&&n.success()}),(function(){n.error&&n.error()}))):(p.szStartTime=p.szStartTime.replace(/[-:]/g,"").replace(" ","T")+"Z",p.szEndTime=p.szEndTime.replace(/[-:]/g,"").replace(" ","T")+"Z",h.oProtocolInc.startPlayback(h,p).then((function(){n.success&&n.success()}),(function(){h.iRtspPort=-1,n.error&&n.error()}))))}else n.error&&n.error()},this.I_ReversePlayback=function(e,n){var r=this.findDeviceIndexByIP(e),s=-1,o="",i="",a=-1,u=-1,d=0,p=f.dateFormat(new Date,"yyyy-MM-dd"),h={iWndIndex:c,iStreamType:1,iChannelID:1,szStartTime:p+" 00:00:00",szEndTime:p+" 23:59:59"};if(f.extend(h,n),-1!=r){H(l[r]);var P=l[r];if(k())return s;if(-1==(a=0==parseInt(t.$XML(m).find("ProtocolType").eq(0).text(),10)&&P.oStreamCapa.bSupportShttpPlay?(o=P.oProtocolInc.CGI.startShttpReversePlayback,i="http://",d=h.iStreamType-1,u=100*(u=h.iChannelID<=P.iAnalogChannelNum?h.iChannelID:P.oStreamCapa.iIpChanBase+parseInt(h.iChannelID,10)-P.iAnalogChannelNum-1)+d,z(h.iPort)?"https://"==P.szHttpProtocol?(-1==P.iHttpPort&&(P.iHttpPort=w(P).iHttpPort),P.iHttpPort):P.iCGIPort:(P.iHttpPort=h.iPort,h.iPort)):(o=P.oProtocolInc.CGI.startPlayback,i="rtsp://",d=h.iStreamType,u=100*h.iChannelID+d,z(h.iRtspPort)||(P.iRtspPort=h.iRtspPort),-1==P.iRtspPort&&(P.iRtspPort=w(P).iRtspPort),P.iRtspPort)))return g("\u83b7\u53d6\u7aef\u53e3\u53f7\u5931\u8d25"),s;f.extend(h,{urlProtocol:i,cgi:o,iPort:a,iChannelID:u}),-1==(r=this.findWndIndexByIndex(h.iWndIndex))&&(h.szStartTime=h.szStartTime.replace(/[-:]/g,"").replace(" ","T")+"Z",h.szEndTime=h.szEndTime.replace(/[-:]/g,"").replace(" ","T")+"Z",s=P.oProtocolInc.reversePlayback(P,h))}return-1==s&&(P.iRtspPort=-1),s},this.I_Frame=function(e){var t={iWndIndex:c};T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e);var n=this.findWndIndexByIndex(t.iWndIndex);if(-1!=n){var r=d[n],s=r.iPlayStatus;2==s||4==s?k()?a.JS_FrameForward(t.iWndIndex).then((function(){r.iPlayStatus=4,t.success&&t.success()}),(function(){t.error&&t.error()})):0==a.HWP_FrameForward(t.iWndIndex)?(r.iPlayStatus=4,t.success&&t.success()):t.error&&t.error():t.error&&t.error()}else t.error&&t.error()},this.I_Pause=function(e){var t={iWndIndex:c};T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e);var n=this.findWndIndexByIndex(t.iWndIndex);if(-1!=n){var r=d[n],s=r.iPlayStatus,o=-1;if(2==s)o=3;else{if(5!=s)return void(t.error&&t.error());o=6}k()?a.JS_Pause(t.iWndIndex).then((function(){r.iPlayStatus=o,t.success&&t.success()}),(function(){t.error&&t.error()})):0==a.HWP_Pause(t.iWndIndex)?(r.iPlayStatus=o,t.success&&t.success()):t.error&&t.error()}else t.error&&t.error()},this.I_Resume=function(e){var t={iWndIndex:c};T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e);var n=this.findWndIndexByIndex(t.iWndIndex);if(-1!=n){var r=d[n],s=r.iPlayStatus,o=-1;if(3==s||4==s)o=2;else{if(6!=s)return void(t.error&&t.error());o=5}k()?a.JS_Resume(t.iWndIndex).then((function(){r.iPlayStatus=o,t.success&&t.success()}),(function(){t.error&&t.error()})):0==a.HWP_Resume(t.iWndIndex)?(r.iPlayStatus=o,t.success&&t.success()):t.error&&t.error()}else t.error&&t.error()},this.I_PlaySlow=function(e){var t={iWndIndex:c};T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e);var n=this.findWndIndexByIndex(t.iWndIndex);-1!=n&&2==d[n].iPlayStatus?k()?a.JS_GetWndStatus(t.iWndIndex).iRate<=-4?t.error&&t.error():a.JS_Slow(t.iWndIndex).then((function(){t.success&&t.success()}),(function(){t.error&&t.error()})):0==a.HWP_Slow(t.iWndIndex)?t.success&&t.success():t.error&&t.error():t.error&&t.error()},this.I_PlayFast=function(e){var t={iWndIndex:c};T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e);var n=this.findWndIndexByIndex(t.iWndIndex);-1!=n&&2==d[n].iPlayStatus?k()?8<=a.JS_GetWndStatus(t.iWndIndex).iRate?t.error&&t.error():a.JS_Fast(t.iWndIndex).then((function(){t.success&&t.success()}),(function(){t.error&&t.error()})):0==a.HWP_Fast(t.iWndIndex)?t.success&&t.success():t.error&&t.error():t.error&&t.error()},this.I_GetOSDTime=function(e){var t={iWndIndex:c};if(T(e)?f.extend(t,e):z(e)||(t.iWndIndex=e),-1!=this.findWndIndexByIndex(t.iWndIndex)){if(k())a.JS_GetOSDTime(t.iWndIndex).then((function(e){if(t.success){var n=f.dateFormat(new Date(1e3*e),"yyyy-MM-dd hh:mm:ss");t.success(n)}}),(function(){t.error&&t.error()}));else if(t.success){var n=a.HWP_GetOSDTime(t.iWndIndex),r=f.dateFormat(new Date(1e3*n),"yyyy-MM-dd hh:mm:ss");t.success(r)}}else t.error&&t.error()},this.I_StartDownloadRecord=function(e,t,n,r){var s=this.findDeviceIndexByIP(e),o=-1;if(-1!=s){var i=l[s],a={szPlaybackURI:t,szFileName:n,bDateDir:!0};z(r)||f.extend(a,r),o=i.oProtocolInc.startDownloadRecord(i,a)}return o},this.I_StartDownloadRecordByTime=function(e,t,n,r,s,o){var i=this.findDeviceIndexByIP(e),a=-1;if(-1!=i){var c=l[i],u={szPlaybackURI:t=t.split("?")[0]+"?starttime="+r.replace(" ","T")+"Z&endtime="+s.replace(" ","T")+"Z",szFileName:n,bDateDir:!0};z(o)||f.extend(u,o),a=c.oProtocolInc.startDownloadRecord(c,u)}return a},this.I_GetDownloadStatus=function(e){var t=-1;return k()||1==(t=a.HWP_GetDownloadStatus(e))&&(t=-1),t},this.I_GetDownloadProgress=function(e){return k()?-1:a.HWP_GetDownloadProgress(e)},this.I_StopDownloadRecord=function(e){return k()?-1:a.HWP_StopDownload(e)},this.I_ExportDeviceConfig=function(e,t){var n=this.findDeviceIndexByIP(e),r=-1;if(-1!=n){var s=l[n];r=s.oProtocolInc.exportDeviceConfig(s,t)}return r},this.I_ImportDeviceConfig=function(e,t,n){var r=this.findDeviceIndexByIP(e),s=-1;if(-1!=r){var o=l[r],i={szFileName:t};s=o.oProtocolInc.importDeviceConfig(o,i,n)}return s},this.I_RestoreDefault=function(e,t,n){var r={success:null,error:null};f.extend(r,n);var s=this.findDeviceIndexByIP(e);if(-1!=s){var o=l[s];o.oProtocolInc.restore(o,t,r)}},this.I_Restart=function(e,t){var n=this.findDeviceIndexByIP(e),r={success:null,error:null};if(f.extend(r,t),-1!=n){var s=l[n];s.oProtocolInc.restart(s,r)}},this.I_Reconnect=function(e,t){var n=this.findDeviceIndexByIP(e),r={success:null,error:null};if(f.extend(r,t),-1!=n){var s=l[n];s.oProtocolInc.login(s.szIP,s.iCGIPort,s.szAuth,r)}},this.I_StartUpgrade=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1==n)return-1;var r=l[n],s={szFileName:t};return k()?-1:r.oProtocolInc.startUpgrade(r,s)},this.I2_StartUpgrade=function(e,t){var n=this.findDeviceIndexByIP(e);if(-1!=n){var r=l[n],s={szFileName:t};return r.oProtocolInc.asyncstartUpgrade(r,s)}},this.I_UpgradeStatus=function(){return k()?a.JS_UpgradeStatus():a.HWP_UpgradeStatus()},this.I_UpgradeProgress=function(){return k()?a.JS_UpgradeProgress():a.HWP_UpgradeProgress()},this.I_StopUpgrade=function(){return k()?-1:a.HWP_StopUpgrade()},this.I_CheckPluginInstall=function(){var e=-1,t=f.browser();if(k())e=0;else if(t.msie)try{new ActiveXObject("WebVideoKitActiveX.WebVideoKitActiveXCtrl.1"),e=0}catch(e){}else for(var n=0,r=navigator.mimeTypes.length;n<r;n++)if("application/webvideo-plugin-kit"==navigator.mimeTypes[n].type.toLowerCase()){e=0;break}return e},this.I_CheckPluginVersion=function(){return k()?0:a.HWP_CheckPluginUpdate("<?xml version='1.0' encoding='utf-8'?><FileVersion><Platform name='win32'><npWebVideoKitPlugin.dll>3,0,6,2</npWebVideoKitPlugin.dll><WebVideoKitActiveX.ocx>3,0,6,2</WebVideoKitActiveX.ocx><PlayCtrl.dll>7,3,3,61</PlayCtrl.dll><StreamTransClient.dll>1,1,3,6</StreamTransClient.dll><SystemTransform.dll>2,5,2,8</SystemTransform.dll><NetStream.dll>1,0,5,59</NetStream.dll></Platform></FileVersion>")?-1:0},this.I_SendHTTPRequest=function(e,t,n){var r=this.findDeviceIndexByIP(e);if(!(r<0)){var s=l[r],o=new O,i={type:"GET",url:s.szHttpProtocol+s.szIP+":"+s.iCGIPort+"/"+t,auth:s.szAuth,success:null,error:null};f.extend(i,n),f.extend(i,{success:function(e){n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),o.setRequestParam(i),o.submitRequest()}},this.I_RemoteConfig=function(e,t){var n=this.findDeviceIndexByIP(e),r=-1;if(k())return-1;var s={iLan:0,iDevicePort:-1,iType:0};if(f.extend(s,t),-1==n)return-1;var o=l[n];if(-1==s.iDevicePort)if(-1==o.iDevicePort){if(o.iDevicePort=w(o).iDevicePort,-1==(r=o.iDevicePort))return-1}else r=o.iDevicePort;else r=s.iDevicePort;if(":"==f.Base64.decode(o.szAuth)[0])var i=f.Base64.decode(o.szAuth).split(":")[1],c=f.Base64.decode(o.szAuth).split(":")[2];else i=f.Base64.decode(o.szAuth).split(":")[0],c=f.Base64.decode(o.szAuth).split(":")[1];var u="<RemoteInfo><DeviceInfo><DeviceType>"+s.iType+"</DeviceType><LanType>"+s.iLan+"</LanType><IP>"+o.szIP+"</IP><Port>"+r+"</Port><UName>"+i+"</UName><PWD>"+f.Base64.encode(c)+"</PWD></DeviceInfo></RemoteInfo>";return a.HWP_ShowRemConfig(u)},this.I_ChangeWndNum=function(e){return isNaN(parseInt(e,10))?-1:(k()?a.JS_ArrangeWindow(e):a.HWP_ArrangeWindow(e),0)},this.I_GetLastError=function(){return k()?-1:a.HWP_GetLastError()},this.I_GetWindowStatus=function(e){if(z(e)){var t=[];return f.extend(t,d),t}var n=this.findWndIndexByIndex(e);return-1==n?null:(t={},f.extend(t,d[n]),t)},this.I_GetIPInfoByMode=function(e,t,n,r){return k()?"":a.HWP_GetIpInfoByMode(e,t,n,r)},this.I_SetPlayModeType=function(e){return k()?0:a.HWP_SetPlayModeType(e)},this.I_SetSnapDrawMode=function(e,t){return k()?-1<t?a.JS_SetDrawStatus(!0):a.JS_SetDrawStatus(!1):a.HWP_SetSnapDrawMode(e,t)},this.I2_SetSnapPolygonInfo=function(e,n){if(k()){a.JS_GetPolygonInfo();var r=f.loadXML(n),s=[];for(nodeList=t.$XML(r).find("SnapPolygon",!0),i=0,iLen=nodeList.length;i<iLen;i++){node=nodeList[i];var o=N(t.$XML(node).find("r").eq(0).text(),t.$XML(node).find("g").eq(0).text(),t.$XML(node).find("b").eq(0).text());o="#"+(o=F(o,6));for(var c=[],u=t.$XML(node).find("point",!0),l=0,d=u.length;l<d;l++)oNodePoint=u[l],c.push([500*t.$XML(oNodePoint).find("x").eq(0).text(),300*t.$XML(oNodePoint).find("y").eq(0).text()]);s.push({iPolygonType:1,id:t.$XML(node).find("id").eq(0).text(),iEditType:0,aPoint:c,bClosed:!0,szTips:t.$XML(node).find("tips").eq(0).text(),szDrawColor:o,iTranslucent:.1})}return a.JS_SetPolygonInfo(s)}return a.HWP_SetSnapPolygonInfo(e,n)},this.I_SetSnapPolygonInfo=function(e,n){if(k()){var r=a.JS_GetPolygonInfo(),s=f.loadXML(n),o=[];for(u=0,l=(P=t.$XML(s).find("SnapPolygon",!0)).length;u<l;u++){I=P[u];var i=N(t.$XML(I).find("r").eq(0).text(),t.$XML(I).find("g").eq(0).text(),t.$XML(I).find("b").eq(0).text());i="#"+(i=F(i,6)),o.push({id:t.$XML(I).find("id").eq(0).text(),tips:t.$XML(I).find("tips").eq(0).text(),iMaxShapeSupport:r.length+1,iMaxPointSupport:t.$XML(I).find("PointNumMax").eq(0).text(),iMinPointSupport:t.$XML(I).find("MinClosed").eq(0).text(),style:{szDrawColor:i,iTranslucent:.1}})}0===P.length&&o.push({iMaxShapeSupport:1,iMaxPointSupport:17,iMinPointSupport:1,style:{szDrawColor:"#FFFF00",iTranslucent:.1}});var c=[];if($.each(r,(function(e,t){c.push(t.id)})),v=","+(v=c.join(","))+",",32<r.length+o.length)return-3;for(var u=0,l=o.length;u<l;u++){var d=(I=o[u]).id;if(!f.isInt(d))return-2;if((m=parseInt(d,10))<1||32<m)return-2;if(-1<v.indexOf(","+d+","))return-4;if(32<I.tips.length)return-2;if(!I.flag){var p=I.iMinPointSupport;if(!f.isInt(p))return-2;if((S=parseInt(p,10))<4||17<S)return-2;var h=I.iMaxPointSupport;if(!f.isInt(h))return-2;if((C=parseInt(h,10))<S||17<C)return-2}}return a.JS_SetDrawShapeInfo("Polygon",o[0])}var P,I,m,S,C,y=a.HWP_GetSnapPolygonInfo(e);s=f.loadXML(y);var v,g=(P=t.$XML(s).find("SnapPolygon",!0)).length;for(c=[],u=0,l=P.length;u<l;u++)I=P[u],c.push(t.$XML(I).find("id").eq(0).text());if(v=","+(v=c.join(","))+",",s=f.loadXML(n),32<g+(P=t.$XML(s).find("SnapPolygon",!0)).length)return-3;for(u=0,l=P.length;u<l;u++){if(I=P[u],d=t.$XML(I).find("id").eq(0).text(),!f.isInt(d))return-2;if((m=parseInt(d,10))<1||32<m)return-2;if(-1<v.indexOf(","+d+","))return-4;if(32<t.$XML(I).find("tips").eq(0).text().length)return-2;if("true"!==t.$XML(I).find("isClosed").eq(0).text()){if(p=t.$XML(I).find("MinClosed").eq(0).text(),!f.isInt(p))return-2;if((S=parseInt(p,10))<4||17<S)return-2;if(h=t.$XML(I).find("PointNumMax").eq(0).text(),!f.isInt(h))return-2;if((C=parseInt(h,10))<S||17<C)return-2}}return a.HWP_SetSnapPolygonInfo(e,n)},this.I_GetSnapPolygonInfo=function(t){if(k()){for(var r=a.JS_GetPolygonInfo(t),s='<?xml version="1.0" encoding="utf-8"?><SnapPolygonList>',o=0;o<r.length;o++){s+="<SnapPolygon>";var i=V(r[o].szDrawColor);s+="<id>"+r[o].szTips.split("#")[1]+"</id><polygonType>1</polygonType><color><r>"+i[0]+"</r><g>"+i[1]+"</g><b>"+i[2]+"</b></color><tips>"+r[o].szTips+"</tips><isClosed>"+r[o].bClosed+"</isClosed><pointList>";for(var c=0;c<r[o].aPoint.length;c++)s+="<point><x>"+r[o].aPoint[c][0]/e+"</x><y>"+r[o].aPoint[c][1]/n+"</y></point>";s+="</pointList></SnapPolygon>"}return s+"</SnapPolygonList>"}return a.HWP_GetSnapPolygonInfo(t)},this.I_ClearSnapInfo=function(e){return k()?a.JS_ClearSnapInfo():a.HWP_ClearSnapInfo(e,1)},this.I_DeviceCapturePic=function(e,t,n,r){var s=this.findDeviceIndexByIP(e),o=-1;if(-1!=s){var i=l[s],a={bDateDir:!0};if(f.extend(a,r),!z(a.iResolutionWidth)&&!f.isInt(a.iResolutionWidth))return o;if(!z(a.iResolutionHeight)&&!f.isInt(a.iResolutionHeight))return o;o=i.oProtocolInc.deviceCapturePic(i,t,n,a)}return o},this.I_SetPackageType=function(e){return k()?-1:a.HWP_SetPackageType(e)},this.I_GetDevicePort=function(e){var t=this.findDeviceIndexByIP(e),n=null;if(-1!=t){var r=l[t];n=w(r)}return n},this.I_GetTextOverlay=function(e,t,n){var r=this.findDeviceIndexByIP(t);if(-1!=r){var s=l[r],o=(d[r],{async:!1,type:"GET",success:n.success,error:n.error});this.I_SendHTTPRequest(s.szIP+"_"+s.iCGIPort,e,o)}return-1},this.findDeviceIndexByIP=function(e){if(-1<e.indexOf("_")){for(var t=0,n=l.length;t<n;t++)if(l[t].szDeviceIdentify==e)return t}else for(t=0,n=l.length;t<n;t++)if(l[t].szIP==e)return t;return-1},this.findWndIndexByIndex=function(e){for(var t=0,n=d.length;t<n;t++)if(d[t].iIndex==e)return t;return-1};var j=function(){this.iIndex=0,this.szIP="",this.iCGIPort=80,this.szDeviceIdentify="",this.iChannelID="",this.iPlayStatus=0,this.bSound=!1,this.bRecord=!1,this.bPTZAuto=!1,this.bEZoom=!1,this.b3DZoom=!1},O=function(){this.options={type:"GET",url:"",auth:"",timeout:1e4,data:"",async:!0,success:null,error:null},this.m_szHttpHead="",this.m_szHttpContent="",this.m_szHttpData=""};O.prototype.m_httpRequestSet=[],O.prototype.setRequestParam=function(e){f.extend(this.options,e)},O.prototype.submitRequest=function(){var e,t=null,n=this;if(k()){this.options.auth?f.cookie("WebSession",this.options.auth):f.cookie("WebSession",null);var r=E(this.options.url),s=new window.XMLHttpRequest;if(s.open(this.options.type,r,this.options.async),o.proxyAddress){s.withCredentials=!0;var i=(e=this.options.url,/^(http|https):\/\/([^\/]+)(.+)$/.test(e)?RegExp.$2:"");s.setRequestHeader("deviceIdentify",i)}s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("If-Modified-Since","0"),s.send(this.options.data||null);var c=function(){if(4===s.readyState){t={funSuccessCallback:n.options.success,funErrorCallback:n.options.error};var e=s.status+s.responseText;0===s.status&&(e=""),n.httpDataAnalyse(t,e)}};this.options.async?(s.timeout=this.options.timeout,s.onreadystatechange=function(){c()}):c()}else{var u=this.getHttpMethod(this.options.type);if(this.options.async){var l=a.HWP_SubmitHttpRequest(u,this.options.url,this.options.auth,this.options.data,this.options.timeout);-1!=l&&(t={iRequestID:l,funSuccessCallback:this.options.success,funErrorCallback:this.options.error},this.m_httpRequestSet.push(t))}else{var d=a.HWP_SendHttpSynRequest(u,this.options.url,this.options.auth,this.options.data,this.options.timeout);t={funSuccessCallback:this.options.success,funErrorCallback:this.options.error},this.httpDataAnalyse(t,d)}}},O.prototype.getHttpMethod=function(e){var t={GET:1,POST:2,PUT:5,DELETE:6}[e];return t||-1},O.prototype.processCallback=function(e,t){for(var n=null,r=0;r<this.m_httpRequestSet.length;r++)if(e==this.m_httpRequestSet[r].iRequestID){n=this.m_httpRequestSet[r],this.m_httpRequestSet.splice(r,1);break}null!=n&&(this.httpDataAnalyse(n,t),delete n)},O.prototype.httpDataAnalyse=function(e,t){var n="",r=0;""==t||z(t)?e.funErrorCallback():(r=parseInt(t.substring(0,3)),n=t.substring(3,t.length),isNaN(r)?e.funErrorCallback():200==r?this.options&&-1<this.options.url.indexOf("?format=json")?e.funSuccessCallback(JSON.parse(n)):e.funSuccessCallback(f.loadXML(n)):e.funErrorCallback&&e.funErrorCallback(r,f.loadXML(n)))};var J=function(){};J.prototype.CGI={login:"%s%s:%s/ISAPI/Security/userCheck",getAudioInfo:"%s%s:%s/ISAPI/System/TwoWayAudio/channels",getDeviceInfo:"%s%s:%s/ISAPI/System/deviceInfo",getAnalogChannelInfo:"%s%s:%s/ISAPI/System/Video/inputs/channels",getDigitalChannel:"%s%s:%s/ISAPI/ContentMgmt/InputProxy/channels",getDigitalChannelInfo:"%s%s:%s/ISAPI/ContentMgmt/InputProxy/channels/status",getZeroChannelInfo:"%s%s:%s/ISAPI/ContentMgmt/ZeroVideo/channels",getStreamChannels:{analog:"%s%s:%s/ISAPI/Streaming/channels",digital:"%s%s:%s/ISAPI/ContentMgmt/StreamingProxy/channels"},getStreamDynChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynStreaming/channels",startRealPlay:{channels:"%s%s:%s/PSIA/streaming/channels/%s",zeroChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/ZeroStreaming/channels/%s"},startShttpRealPlay:{channels:"%s%s:%s/SDK/play/%s/004",zeroChannels:"%s%s:%s/SDK/play/100/004/ZeroStreaming"},startWsRealPlay:{channels:"%s%s:%s/%s",zeroChannels:"%s%s:%s/%s"},startVoiceTalk:{open:"%s%s:%s/ISAPI/System/TwoWayAudio/channels/%s/open",close:"%s%s:%s/ISAPI/System/TwoWayAudio/channels/%s/close",audioData:"%s%s:%s/ISAPI/System/TwoWayAudio/channels/%s/audioData"},ptzControl:{analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/continuous",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/continuous"},ptzAutoControl:{ipdome:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/presets/%s/goto",analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/autoPan",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/autoPan"},setPreset:{analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/presets/%s",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/presets/%s"},goPreset:{analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/presets/%s/goto",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/presets/%s/goto"},ptzFocus:{analog:"%s%s:%s/ISAPI/Image/channels/%s/focus",digital:"%s%s:%s/ISAPI/ContentMgmt/ImageProxy/channels/%s/focus",ipc:"%s%s:%s/ISAPI/System/Video/inputs/channels/%s/focus"},ptzIris:{analog:"%s%s:%s/ISAPI/Image/channels/%s/iris",digital:"%s%s:%s/ISAPI/ContentMgmt/ImageProxy/channels/%s/iris",ipc:"%s%s:%s/ISAPI/System/Video/inputs/channels/%s/iris"},getNetworkBond:"%s%s:%s/ISAPI/System/Network/Bond",getNetworkInterface:"%s%s:%s/ISAPI/System/Network/interfaces",getUPnPPortStatus:"%s%s:%s/ISAPI/System/Network/UPnP/ports/status",getPPPoEStatus:"%s%s:%s/ISAPI/System/Network/PPPoE/1/status",getPortInfo:"%s%s:%s/ISAPI/Security/adminAccesses",recordSearch:"%s%s:%s/ISAPI/ContentMgmt/search",startPlayback:"%s%s:%s/PSIA/streaming/tracks/%s?starttime=%s&endtime=%s",startWsPlayback:"%s%s:%s/%s",startShttpPlayback:"%s%s:%s/SDK/playback/%s",startShttpReversePlayback:"%s%s:%s/SDK/playback/%s/reversePlay",startTransCodePlayback:"%s%s:%s/SDK/playback/%s/transcoding",startDownloadRecord:"%s%s:%s/ISAPI/ContentMgmt/download",downloaddeviceConfig:"%s%s:%s/ISAPI/System/configurationData",uploaddeviceConfig:"%s%s:%s/ISAPI/System/configurationData",restart:"%s%s:%s/ISAPI/System/reboot",restore:"%s%s:%s/ISAPI/System/factoryReset?mode=%s",startUpgrade:{upgrade:"%s%s:%s/ISAPI/System/updateFirmware",status:"%s%s:%s/ISAPI/System/upgradeStatus"},set3DZoom:{analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/position3D",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/position3D"},getSecurityVersion:"%s%s:%s/ISAPI/Security/capabilities?username=admin",SDKCapabilities:"%s%s:%s/SDK/capabilities",deviceCapture:{channels:"%s%s:%s/ISAPI/Streaming/channels/%s/picture"},overlayInfo:{analog:"%s%s:%s/ISAPI/System/Video/inputs/channels/%s/overlays/",digital:"%s%s:%s/ISAPI/ContentMgmt/InputProxy/channels/%s/video/overlays"},sessionCap:"%s%s:%s/ISAPI/Security/sessionLogin/capabilities?username=%s",sessionLogin:"%s%s:%s/ISAPI/Security/sessionLogin",sessionHeartbeat:"%s%s:%s/ISAPI/Security/sessionHeartbeat",sessionLogout:"%s%s:%s/ISAPI/Security/sessionLogout",systemCapabilities:"%s%s:%s/ISAPI/System/capabilities"},J.prototype.login=function(e,t,n,r){var s=2==r.protocol?"https://":"http://",o=x(this.CGI.login,s,e,t),i=new O,a={type:"GET",url:o,auth:n,success:null,error:null};f.extend(a,r),f.extend(a,{success:function(e){r.success&&r.success(e)},error:function(e,t){r.error&&r.error(e,t)}}),i.setRequestParam(a),i.submitRequest()},J.prototype.getAudioInfo=function(e,t){var n=x(this.CGI.getAudioInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getSecurityVersion=function(e,t){var n=x(this.CGI.getSecurityVersion,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getDeviceInfo=function(e,n){var r=x(this.CGI.getDeviceInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"GET",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){var r=[];r.push("<DeviceInfo>"),r.push("<deviceName>"+f.escape(t.$XML(e).find("deviceName").eq(0).text())+"</deviceName>"),r.push("<deviceID>"+t.$XML(e).find("deviceID").eq(0).text()+"</deviceID>"),r.push("<deviceType>"+t.$XML(e).find("deviceType").eq(0).text()+"</deviceType>"),r.push("<model>"+t.$XML(e).find("model").eq(0).text()+"</model>"),r.push("<serialNumber>"+t.$XML(e).find("serialNumber").eq(0).text()+"</serialNumber>"),r.push("<macAddress>"+t.$XML(e).find("macAddress").eq(0).text()+"</macAddress>"),r.push("<firmwareVersion>"+t.$XML(e).find("firmwareVersion").eq(0).text()+"</firmwareVersion>"),r.push("<firmwareReleasedDate>"+t.$XML(e).find("firmwareReleasedDate").eq(0).text()+"</firmwareReleasedDate>"),r.push("<encoderVersion>"+t.$XML(e).find("encoderVersion").eq(0).text()+"</encoderVersion>"),r.push("<encoderReleasedDate>"+t.$XML(e).find("encoderReleasedDate").eq(0).text()+"</encoderReleasedDate>"),r.push("</DeviceInfo>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},J.prototype.getAnalogChannelInfo=function(e,n){var r=x(this.CGI.getAnalogChannelInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"GET",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(r){var s=[];s.push("<VideoInputChannelList>");var o=t.$XML(r).find("VideoInputChannel",!0);e.iAnalogChannelNum=o.length;for(var i=0,a=o.length;i<a;i++){var c=o[i];s.push("<VideoInputChannel>"),s.push("<id>"+t.$XML(c).find("id").eq(0).text()+"</id>"),s.push("<inputPort>"+t.$XML(c).find("inputPort").eq(0).text()+"</inputPort>"),s.push("<name>"+f.escape(t.$XML(c).find("name").eq(0).text())+"</name>"),s.push("<videoFormat>"+t.$XML(c).find("videoFormat").eq(0).text()+"</videoFormat>"),s.push("</VideoInputChannel>")}s.push("</VideoInputChannelList>"),r=f.loadXML(s.join("")),n.success&&n.success(r)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},J.prototype.getDigitalChannel=function(e,n){var r=x(this.CGI.getDigitalChannel,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"GET",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){var r=[];r.push("<InputProxyChannelList>");for(var s=t.$XML(e).find("InputProxyChannel",!0),o=0,i=s.length;o<i;o++){var a=s[o];r.push("<InputProxyChannel>"),r.push("<id>"+t.$XML(a).find("id").eq(0).text()+"</id>"),r.push("<name>"+f.escape(t.$XML(a).find("name").eq(0).text())+"</name>"),r.push("</InputProxyChannel>")}r.push("</InputProxyChannelList>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},J.prototype.getDigitalChannelInfo=function(e,n){var r=null,s={};if(this.getDigitalChannel(e,{async:!1,success:function(e){r=e;for(var n=t.$XML(r).find("InputProxyChannel",!0),o=0,i=n.length;o<i;o++){var a=n[o],c=t.$XML(a).find("id").eq(0).text(),u=t.$XML(a).find("name").eq(0).text();s[c]=u}},error:function(e,t){n.error&&n.error(e,t)}}),null!==r){var o=x(this.CGI.getDigitalChannelInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),i=new O,a={type:"GET",url:o,auth:e.szAuth,success:null,error:null};f.extend(a,n),f.extend(a,{success:function(e){var r=[];r.push("<InputProxyChannelStatusList>");for(var o=t.$XML(e).find("InputProxyChannelStatus",!0),i=0,a=o.length;i<a;i++){var c=o[i],u=t.$XML(c).find("id").eq(0).text();r.push("<InputProxyChannelStatus>"),r.push("<id>"+u+"</id>"),r.push("<sourceInputPortDescriptor>"),r.push("<proxyProtocol>"+t.$XML(c).find("proxyProtocol").eq(0).text()+"</proxyProtocol>"),r.push("<addressingFormatType>"+t.$XML(c).find("addressingFormatType").eq(0).text()+"</addressingFormatType>"),r.push("<ipAddress>"+t.$XML(c).find("ipAddress").eq(0).text()+"</ipAddress>"),r.push("<managePortNo>"+t.$XML(c).find("managePortNo").eq(0).text()+"</managePortNo>"),r.push("<srcInputPort>"+t.$XML(c).find("srcInputPort").eq(0).text()+"</srcInputPort>"),r.push("<userName>"+f.escape(t.$XML(c).find("userName").eq(0).text())+"</userName>"),r.push("<streamType>"+t.$XML(c).find("streamType").eq(0).text()+"</streamType>"),r.push("<online>"+t.$XML(c).find("online").eq(0).text()+"</online>"),r.push("<name>"+f.escape(s[u])+"</name>"),r.push("</sourceInputPortDescriptor>"),r.push("</InputProxyChannelStatus>")}r.push("</InputProxyChannelStatusList>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),i.setRequestParam(a),i.submitRequest()}},J.prototype.getZeroChannelInfo=function(e,t){var n=x(this.CGI.getZeroChannelInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getStreamChannels=function(e,t){if(0!=e.iAnalogChannelNum)var n=x(this.CGI.getStreamChannels.analog,e.szHttpProtocol,e.szIP,e.iCGIPort);else n=x(this.CGI.getStreamChannels.digital,e.szHttpProtocol,e.szIP,e.iCGIPort);var r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getPPPoEStatus=function(e,t){var n=x(this.CGI.getPPPoEStatus,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getUPnPPortStatus=function(e,t){var n=x(this.CGI.getUPnPPortStatus,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getNetworkBond=function(e,t){var n=x(this.CGI.getNetworkBond,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getNetworkInterface=function(e,t){var n=x(this.CGI.getNetworkInterface,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getPortInfo=function(e,t){var n=x(this.CGI.getPortInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.startRealPlay=function(e,t){var n=100*t.iChannelID+t.iStreamType,r="",s=e.szIP;if("rtsp://"===t.urlProtocol&&(s=D(s)),r=t.bZeroChannel?(k()&&(n=0),x(t.cgi.zeroChannels,t.urlProtocol,s,t.iPort,n)):x(t.cgi.channels,t.urlProtocol,s,t.iPort,n),o.proxyAddress&&k()){f.cookie("webVideoCtrlProxy",s+":"+t.iPort,{raw:!0}),r=x(t.cgi.zeroChannels,t.urlProtocol,o.proxyAddress.ip,o.proxyAddress.wsport,n);var i=s+":"+t.iPort;-1<r.indexOf("?")?r+="&deviceIdentify="+i:r+="?deviceIdentify="+i}var c=function(){var n=new j;n.iIndex=t.iWndIndex,n.szIP=e.szIP,n.iCGIPort=e.iCGIPort,n.szDeviceIdentify=e.szDeviceIdentify,n.iChannelID=t.iChannelID,n.iPlayStatus=1,d.push(n)},u=$.Deferred();if(k()){var l={sessionID:e.szAuth,token:b(0,e.szDeviceIdentify)};a.JS_Play(r,l,t.iWndIndex).then((function(){c(),u.resolve()}),(function(){u.reject()}))}else 0==a.HWP_Play(r,e.szAuth,t.iWndIndex,"","")?(c(),u.resolve()):u.reject();return u},J.prototype.startVoiceTalk=function(e,t){var n=x(this.CGI.startVoiceTalk.open,e.szHttpProtocol,e.szIP,e.iCGIPort,t),r=x(this.CGI.startVoiceTalk.close,e.szHttpProtocol,e.szIP,e.iCGIPort,t),s=x(this.CGI.startVoiceTalk.audioData,e.szHttpProtocol,e.szIP,e.iCGIPort,t);return a.HWP_StartVoiceTalkEx(n,r,s,e.szAuth,e.iAudioType,e.m_iAudioBitRate,e.m_iAudioSamplingRate)},J.prototype.ptzAutoControl=function(e,t,n,r){var s=n.iChannelID,o="",i="";if(r.iPTZSpeed=r.iPTZSpeed<7?15*r.iPTZSpeed:100,t&&(r.iPTZSpeed=0),e.szDeviceType!=y)o=s<=e.iAnalogChannelNum?x(this.CGI.ptzAutoControl.analog,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID):n.bShttpIPChannel?x(this.CGI.ptzAutoControl.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID-e.oStreamCapa.iIpChanBase+1+e.iAnalogChannelNum):x(this.CGI.ptzAutoControl.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID),i="<?xml version='1.0' encoding='UTF-8'?><autoPanData><autoPan>"+r.iPTZSpeed+"</autoPan></autoPanData>";else{0===r.iPTZSpeed&&(t=!0);var a=99;t&&(a=96),o=x(this.CGI.ptzAutoControl.ipdome,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID,a)}var c=new O,u={type:"PUT",url:o,async:!1,auth:e.szAuth,data:i,success:null,error:null},l=this;f.extend(u,r),f.extend(u,{success:function(e){n.bPTZAuto=!n.bPTZAuto,r.success&&r.success(e)},error:function(t,s){if(C==e.szDeviceType||v==e.szDeviceType){o=n.bShttpIPChannel?x(l.CGI.ptzControl.analog,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID-e.oStreamCapa.iIpChanBase+1+e.iAnalogChannelNum):x(l.CGI.ptzControl.analog,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID),i="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+r.iPTZSpeed+"</pan><tilt>0</tilt></PTZData>";var a=new O,c={type:"PUT",url:o,async:!1,auth:e.szAuth,data:i,success:null,error:null};f.extend(c,r),a.setRequestParam(c),a.submitRequest()}else r.error&&r.error(t,s)}}),c.setRequestParam(u),c.submitRequest()},J.prototype.ptzControl=function(e,t,n,r){var s=n.iChannelID,o="";n.bPTZAuto&&this.ptzAutoControl(e,!0,n,{iPTZSpeed:0}),r.iPTZSpeed=t?0:r.iPTZSpeed<7?15*r.iPTZSpeed:100;var i=[{},{pan:0,tilt:r.iPTZSpeed},{pan:0,tilt:-r.iPTZSpeed},{pan:-r.iPTZSpeed,tilt:0},{pan:r.iPTZSpeed,tilt:0},{pan:-r.iPTZSpeed,tilt:r.iPTZSpeed},{pan:-r.iPTZSpeed,tilt:-r.iPTZSpeed},{pan:r.iPTZSpeed,tilt:r.iPTZSpeed},{pan:r.iPTZSpeed,tilt:-r.iPTZSpeed},{},{speed:r.iPTZSpeed},{speed:-r.iPTZSpeed},{speed:r.iPTZSpeed},{speed:-r.iPTZSpeed},{speed:r.iPTZSpeed},{speed:-r.iPTZSpeed}],a="",c={};switch(r.iPTZIndex){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:c=this.CGI.ptzControl,a="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+i[r.iPTZIndex].pan+"</pan><tilt>"+i[r.iPTZIndex].tilt+"</tilt></PTZData>";break;case 10:case 11:c=this.CGI.ptzControl,a="<?xml version='1.0' encoding='UTF-8'?><PTZData><zoom>"+i[r.iPTZIndex].speed+"</zoom></PTZData>";break;case 12:case 13:c=this.CGI.ptzFocus,a="<?xml version='1.0' encoding='UTF-8'?><FocusData><focus>"+i[r.iPTZIndex].speed+"</focus></FocusData>";break;case 14:case 15:c=this.CGI.ptzIris,a="<?xml version='1.0' encoding='UTF-8'?><IrisData><iris>"+i[r.iPTZIndex].speed+"</iris></IrisData>";break;default:return void(r.error&&r.error())}o=c!=this.CGI.ptzFocus&&c!=this.CGI.ptzIris||e.szDeviceType!=C&&e.szDeviceType!=y&&e.szDeviceType!=v?s<=e.iAnalogChannelNum?x(c.analog,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID):n.bShttpIPChannel?x(c.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID-e.oStreamCapa.iIpChanBase+1+e.iAnalogChannelNum):x(c.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID):x(c.ipc,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID);var u=new O,l={type:"PUT",url:o,async:!1,auth:e.szAuth,data:a,success:null,error:null};f.extend(l,r),f.extend(l,{success:function(e){r.success&&r.success(e)},error:function(e,t){r.error&&r.error(e,t)}}),u.setRequestParam(l),u.submitRequest()},J.prototype.setPreset=function(e,t,n){var r="",s="";r=t.iChannelID<=e.iAnalogChannelNum?x(this.CGI.setPreset.analog,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID,n.iPresetID):t.bShttpIPChannel?x(this.CGI.setPreset.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID-e.oStreamCapa.iIpChanBase+1+e.iAnalogChannelNum,n.iPresetID):x(this.CGI.setPreset.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID,n.iPresetID),s="<?xml version='1.0' encoding='UTF-8'?>",s+="<PTZPreset>",s+="<id>"+n.iPresetID+"</id>",e.szDeviceType!=y&&(s+="<presetName>Preset"+n.iPresetID+"</presetName>"),s+="</PTZPreset>";var o=new O,i={type:"PUT",url:r,auth:e.szAuth,data:s,success:null,error:null};f.extend(i,n),f.extend(i,{success:function(e){n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),o.setRequestParam(i),o.submitRequest()},J.prototype.goPreset=function(e,t,n){var r="";r=t.iChannelID<=e.iAnalogChannelNum?x(this.CGI.goPreset.analog,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID,n.iPresetID):t.bShttpIPChannel?x(this.CGI.goPreset.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID-e.oStreamCapa.iIpChanBase+1+e.iAnalogChannelNum,n.iPresetID):x(this.CGI.goPreset.digital,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID,n.iPresetID);var s=new O,o={type:"PUT",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},J.prototype.overlayInfo=function(){return szUrl=this.CGI.overlayInfo.analog,szUrl},J.prototype.recordSearch=function(e,n){var r,s,o=n.iChannelID,i=n.iStreamType,a=n.szStartTime.replace(" ","T")+"Z",c=n.szEndTime.replace(" ","T")+"Z";r=x(this.CGI.recordSearch,e.szHttpProtocol,e.szIP,e.iCGIPort),s="<?xml version='1.0' encoding='UTF-8'?><CMSearchDescription><searchID>"+new ne+"</searchID><trackList><trackID>"+(100*o+i)+"</trackID></trackList><timeSpanList><timeSpan><startTime>"+a+"</startTime><endTime>"+c+"</endTime></timeSpan></timeSpanList><maxResults>40</maxResults><searchResultPostion>"+n.iSearchPos+"</searchResultPostion><metadataList><metadataDescriptor>//metadata.ISAPI.org/VideoMotion</metadataDescriptor></metadataList></CMSearchDescription>";var u=new O,l={type:"POST",url:r,auth:e.szAuth,data:s,success:null,error:null};f.extend(l,n),f.extend(l,{success:function(e){var r=[];r.push("<CMSearchResult>"),r.push("<responseStatus>"+t.$XML(e).find("responseStatus").eq(0).text()+"</responseStatus>"),r.push("<responseStatusStrg>"+t.$XML(e).find("responseStatusStrg").eq(0).text()+"</responseStatusStrg>"),r.push("<numOfMatches>"+t.$XML(e).find("numOfMatches").eq(0).text()+"</numOfMatches>"),r.push("<matchList>");for(var s=t.$XML(e).find("searchMatchItem",!0),o=0,i=s.length;o<i;o++){var a=s[o];r.push("<searchMatchItem>"),r.push("<trackID>"+t.$XML(a).find("trackID").eq(0).text()+"</trackID>"),r.push("<startTime>"+t.$XML(a).find("startTime").eq(0).text()+"</startTime>"),r.push("<endTime>"+t.$XML(a).find("endTime").eq(0).text()+"</endTime>"),r.push("<playbackURI>"+f.escape(t.$XML(a).find("playbackURI").eq(0).text())+"</playbackURI>"),r.push("<metadataDescriptor>"+t.$XML(a).find("metadataDescriptor").eq(0).text().split("/")[1]+"</metadataDescriptor>"),r.push("</searchMatchItem>")}r.push("</matchList>"),r.push("</CMSearchResult>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),u.setRequestParam(l),u.submitRequest()},J.prototype.startPlayback=function(e,t){var n=t.iWndIndex,r="",s=t.szStartTime,i=t.szEndTime,c=e.szIP;if("rtsp://"===t.urlProtocol&&(c=D(c)),k())if(o.proxyAddress){f.cookie("webVideoCtrlProxy",c+":"+t.iPort,{raw:!0}),r=x(t.cgi,t.urlProtocol,o.proxyAddress.ip,o.proxyAddress.wsport,t.iChannelID);var u=c+":"+t.iPort;-1<r.indexOf("?")?r+="&deviceIdentify="+u:r+="?deviceIdentify="+u}else r=x(t.cgi,t.urlProtocol,c,t.iPort,t.iChannelID,s,i);else r=x(t.cgi,t.urlProtocol,c,t.iPort,t.iChannelID,s,i);if(!z(t.oTransCodeParam)){var l=function(e){var t={TransFrameRate:"",TransResolution:"",TransBitrate:""};if(f.extend(t,e),""==t.TransFrameRate||""==t.TransResolution||""==t.TransBitrate)return"";var n=[];return n.push("<?xml version='1.0' encoding='UTF-8'?>"),n.push("<CompressionInfo>"),n.push("<TransFrameRate>"+t.TransFrameRate+"</TransFrameRate>"),n.push("<TransResolution>"+t.TransResolution+"</TransResolution>"),n.push("<TransBitrate>"+t.TransBitrate+"</TransBitrate>"),n.push("</CompressionInfo>"),n.join("")}(t.oTransCodeParam);if(""==l)return-1;a.HWP_SetTrsPlayBackParam(n,l)}var p=function(){var r=new j;r.iIndex=n,r.szIP=e.szIP,r.iCGIPort=e.iCGIPort,r.szDeviceIdentify=e.szDeviceIdentify,r.iChannelID=t.iChannelID,r.iPlayStatus=2,d.push(r)},h=$.Deferred();if(k()){var P={sessionID:e.szAuth,token:b(0,e.szDeviceIdentify)};a.JS_Play(r,P,n,s,i).then((function(){p(),h.resolve()}),(function(){h.reject()}))}else 0==a.HWP_Play(r,e.szAuth,n,s,i)?(p(),h.resolve()):h.reject();return h},J.prototype.reversePlayback=function(e,t){var n=t.iWndIndex,r=t.szStartTime,s=t.szEndTime,o=e.szIP;"rtsp://"===t.urlProtocol&&(o=D(o));var i=x(t.cgi,t.urlProtocol,o,t.iPort,t.iChannelID,r,s),c=a.HWP_ReversePlay(i,e.szAuth,n,r,s);if(0==c){var u=new j;u.iIndex=n,u.szIP=e.szIP,u.iCGIPort=e.iCGIPort,u.szDeviceIdentify=e.szDeviceIdentify,u.iChannelID=t.iChannelID,u.iPlayStatus=5,d.push(u)}return c},J.prototype.startDownloadRecord=function(e,t){var n=x(this.CGI.startDownloadRecord,e.szHttpProtocol,e.szIP,e.iCGIPort),r="<?xml version='1.0' encoding='UTF-8'?><downloadRequest><playbackURI> "+f.escape(t.szPlaybackURI)+"</playbackURI></downloadRequest>";return k()?(n=E(n),a.JS_StartDownload(n,e.szAuth,t.szFileName,r)):a.HWP_StartDownload(n,e.szAuth,t.szFileName,r,t.bDateDir)},J.prototype.exportDeviceConfig=function(e,t){var n=x(this.CGI.downloaddeviceConfig,e.szHttpProtocol,e.szIP,e.iCGIPort);if(k()){var r={type:"PUT",url:n,auth:e.szAuth,success:function(){},error:function(){}},s=new O;return s.setRequestParam(r),s.submitRequest(),n=E(n),t&&(n=f.exportPasswordDeviceConfig(n,t)),a.JS_ExportDeviceConfig(n)}return t&&(n=f.exportPasswordDeviceConfig(n,t)),a.HWP_ExportDeviceConfig(n,e.szAuth,"",0)},J.prototype.importDeviceConfig=function(e,t,n){var r=x(this.CGI.uploaddeviceConfig,e.szHttpProtocol,e.szIP,e.iCGIPort);if(k()){var s={type:"PUT",url:r,auth:e.szAuth,success:function(){},error:function(){}},o=new O;return o.setRequestParam(s),o.submitRequest(),r=E(r),n&&(r=f.exportPasswordDeviceConfig(r,n)),a.JS_UploadFile(r)}return n&&(r=f.exportPasswordDeviceConfig(r,n)),a.HWP_ImportDeviceConfig(r,e.szAuth,t.szFileName,0)},J.prototype.restart=function(e,t){var n=x(this.CGI.restart,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"PUT",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.restore=function(e,t,n){var r=x(this.CGI.restore,e.szHttpProtocol,e.szIP,e.iCGIPort,t),s=new O,o={type:"PUT",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},J.prototype.startUpgrade=function(e,t){$.Deferred();var n=x(this.CGI.startUpgrade.upgrade,e.szHttpProtocol,e.szIP,e.iCGIPort),r=x(this.CGI.startUpgrade.status,e.szHttpProtocol,e.szIP,e.iCGIPort);return szRet=a.HWP_StartUpgrade(n,r,e.szAuth,t.szFileName)},J.prototype.asyncstartUpgrade=function(e,t){var n=$.Deferred(),r=x(this.CGI.startUpgrade.upgrade,e.szHttpProtocol,e.szIP,e.iCGIPort),s=x(this.CGI.startUpgrade.status,e.szHttpProtocol,e.szIP,e.iCGIPort);if(k())r=E(r),s=E(s),a.JS_StartUpgradeEx(r,s).then((function(e){n.resolve(e)}),(function(){n.reject(o)}));else{var o=a.HWP_StartUpgrade(r,s,e.szAuth,t.szFileName);0===o?n.resolve(o):n.reject(o)}return n},J.prototype.set3DZoom=function(r,s,o,i){var a="";if(a=s.iChannelID<=r.iAnalogChannelNum?x(this.CGI.set3DZoom.analog,r.szHttpProtocol,r.szIP,r.iCGIPort,s.iChannelID):s.bShttpIPChannel?x(this.CGI.set3DZoom.digital,r.szHttpProtocol,r.szIP,r.iCGIPort,s.iChannelID-r.oStreamCapa.iIpChanBase+1+r.iAnalogChannelNum):x(this.CGI.set3DZoom.digital,r.szHttpProtocol,r.szIP,r.iCGIPort,s.iChannelID),k())var c=f.loadXML(o),u=parseInt(o.startPos[0]/e*255,10),l=parseInt(o.startPos[1]/n*255,10),d=parseInt(o.endPos[0]/e*255,10),p=parseInt(o.endPos[1]/n*255,10);else c=f.loadXML(o),u=parseInt(t.$XML(c).find("StartPoint").eq(0).find("positionX").eq(0).text(),10),l=parseInt(t.$XML(c).find("StartPoint").eq(0).find("positionY").eq(0).text(),10),d=parseInt(t.$XML(c).find("EndPoint").eq(0).find("positionX").eq(0).text(),10),p=parseInt(t.$XML(c).find("EndPoint").eq(0).find("positionY").eq(0).text(),10);var h="<?xml version='1.0' encoding='UTF-8'?><Position3D><StartPoint><positionX>"+u+"</positionX><positionY>"+(255-l)+"</positionY></StartPoint><EndPoint><positionX>"+d+"</positionX><positionY>"+(255-p)+"</positionY></EndPoint></Position3D>",P=new O,I={type:"PUT",url:a,data:h,auth:r.szAuth,success:null,error:null};f.extend(I,i),f.extend(I,{success:function(e){i.success&&i.success(e)},error:function(e,t){i.error&&i.error(e,t)}}),P.setRequestParam(I),P.submitRequest()},J.prototype.getSDKCapa=function(e,t){var n=x(this.CGI.SDKCapabilities,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,async:!1,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.deviceCapturePic=function(e,t,n,r){t=100*t+1;var s,o,i=-1,c=x(this.CGI.deviceCapture.channels,e.szHttpProtocol,e.szIP,e.iCGIPort,t),u=[];return f.isInt(r.iResolutionWidth)&&u.push("videoResolutionWidth="+r.iResolutionWidth),f.isInt(r.iResolutionHeight)&&u.push("videoResolutionHeight="+r.iResolutionHeight),0<u.length&&(c+="?"+u.join("&")),k()?(c=E(c),s=c,o=n,$("body").append('<a id="jsplugin_download_a" href="'+s+'" download='+o+'.jpg><li id="jsplugin_download_li"></li></a>'),$("#jsplugin_download_li").trigger("click"),$("#jsplugin_download_a").remove(),i=0):i=a.HWP_DeviceCapturePic(c,e.szAuth,n,r.bDateDir),i},J.prototype.getSessionV2Cap=function(e,t,n,r,s,o){var i="";i=2==n?"https://":"http://";var a=x(this.CGI.sessionCap,i,t,r,encodeURIComponent(s));a=a+"&random:"+e;var c=new O,u={type:"GET",url:a,auth:"",success:null,error:null};f.extend(u,o),f.extend(u,{success:function(e){o.success&&o.success(e)},error:function(e,t){o.error&&o.error(e,t)}}),c.setRequestParam(u),c.submitRequest()},J.prototype.getSessionCap=function(e,t,n,r,s){var o="";o=2==t?"https://":"http://";var i=x(this.CGI.sessionCap,o,e,n,encodeURIComponent(r)),a=new O,c={type:"GET",url:i,auth:"",success:null,error:null};f.extend(c,s),f.extend(c,{success:function(e){s.success&&s.success(e)},error:function(e,t){s.error&&s.error(e,t)}}),a.setRequestParam(c),a.submitRequest()},J.prototype.sessionV2Login=function(e,n,r,s,o,i,a,c){var u="";u=2==r?"https://":"http://";var l=parseInt(t.$XML(a).find("sessionIDVersion").eq(0).text(),10),d="true"===t.$XML(a).find("isSessionIDValidLongTerm").eq(0).text(),p=x(this.CGI.sessionLogin,u,n,s),h=t.$XML(a).find("sessionID").eq(0).text(),P=t.$XML(a).find("challenge").eq(0).text(),I=parseInt(t.$XML(a).find("iterations").eq(0).text(),10),m=!1,S="";0<t.$XML(a).find("isIrreversible",!0).length&&(m="true"===t.$XML(a).find("isIrreversible").eq(0).text(),S=t.$XML(a).find("salt").eq(0).text()),this.m_oInfoForLocalPlgin={szRandom:e,sessionID:h,iterations:I,challenge:P,user:o};var C=f.encodePwd(i,{challenge:P,userName:o,salt:S,iIterate:I},m),y="<SessionLogin>";y+="<userName>"+f.escape(o)+"</userName>",y+="<password>"+C+"</password>",y+="<sessionID>"+h+"</sessionID>",y+="<isSessionIDValidLongTerm>"+d+"</isSessionIDValidLongTerm>",y+="<sessionIDVersion>"+l+"</sessionIDVersion>",y+="</SessionLogin>";var v=new O,g={type:"POST",url:p,data:y,auth:"",success:null,error:null};f.extend(g,c),f.extend(g,{success:function(e){c.success&&c.success(e)},error:function(e,t){c.error&&c.error(e,t)}}),v.setRequestParam(g),v.submitRequest()},J.prototype.sessionLogin=function(e,n,r,s,o,i,a){var c="";c=2==n?"https://":"http://";var u=x(this.CGI.sessionLogin,c,e,r),l=t.$XML(i).find("sessionID").eq(0).text(),d=t.$XML(i).find("challenge").eq(0).text(),p=parseInt(t.$XML(i).find("iterations").eq(0).text(),10),h=!1,P="";0<t.$XML(i).find("isIrreversible",!0).length&&(h="true"===t.$XML(i).find("isIrreversible").eq(0).text(),P=t.$XML(i).find("salt").eq(0).text());var I="";if(h)for(I=f.sha256(s+P+o),I=f.sha256(I+d),m=2;m<p;m++)I=f.sha256(I);else{I=f.sha256(o)+d;for(var m=1;m<p;m++)I=f.sha256(I)}var S="<SessionLogin>";S+="<userName>"+f.escape(s)+"</userName>",S+="<password>"+I+"</password>",S+="<sessionID>"+l+"</sessionID>",S+="</SessionLogin>";var C=new O,y={type:"POST",url:u,data:S,auth:"",success:null,error:null};f.extend(y,a),f.extend(y,{success:function(e){a.success&&a.success(e)},error:function(e,t){a.error&&a.error(e,t)}}),C.setRequestParam(y),C.submitRequest()},J.prototype.sessionHeartbeat=function(e,t,n){var r=x(this.CGI.sessionHeartbeat,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"PUT",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,{success:function(e){t&&t(e)},error:function(e,t){n&&n(e,t)}}),s.setRequestParam(o),s.submitRequest()},J.prototype.sessionLogout=function(e,t){var n=x(this.CGI.sessionLogout,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"PUT",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},J.prototype.getSystemCapa=function(e,t){var n=x(this.CGI.systemCapabilities,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,async:!1,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()};var K=function(){};K.prototype.CGI={login:"%s%s:%s/PSIA/Custom/SelfExt/userCheck",getAudioInfo:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels",getDeviceInfo:"%s%s:%s/PSIA/System/deviceInfo",getAnalogChannelInfo:"%s%s:%s/PSIA/System/Video/inputs/channels",getDigitalChannel:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynVideo/inputs/channels",getDigitalChannelInfo:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynVideo/inputs/channels/status",getZeroChannelInfo:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/ZeroVideo/channels",getStreamChannels:{analog:"%s%s:%s/PSIA/Streaming/channels",digital:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynStreaming/channels"},getStreamDynChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynStreaming/channels",startRealPlay:{channels:"%s%s:%s/PSIA/streaming/channels/%s",zeroChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/ZeroStreaming/channels/%s"},startVoiceTalk:{open:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels/%s/open",close:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels/%s/close",audioData:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels/%s/audioData"},ptzControl:"%s%s:%s/PSIA/PTZ/channels/%s/continuous",ptzAutoControl:"%s%s:%s/PSIA/Custom/SelfExt/PTZ/channels/%s/autoptz",setPreset:"%s%s:%s/PSIA/PTZ/channels/%s/presets/%s",goPreset:"%s%s:%s/PSIA/PTZ/channels/%s/presets/%s/goto",ptzFocus:"%s%s:%s/PSIA/System/Video/inputs/channels/%s/focus",ptzIris:"%s%s:%s/PSIA/System/Video/inputs/channels/%s/iris",getNetworkBond:"%s%s:%s/PSIA/Custom/SelfExt/Bond",getNetworkInterface:"%s%s:%s/PSIA/System/Network/interfaces",getUPnPPortStatus:"%s%s:%s/PSIA/Custom/SelfExt/UPnP/ports/status",getPPPoEStatus:"%s%s:%s/PSIA/Custom/SelfExt/PPPoE/1/status",getPortInfo:"%s%s:%s/PSIA/Security/AAA/adminAccesses",recordSearch:"%s%s:%s/PSIA/ContentMgmt/search",startPlayback:"%s%s:%s/PSIA/streaming/tracks/%s?starttime=%s&endtime=%s",startDownloadRecord:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/download",deviceConfig:"%s%s:%s/PSIA/System/configurationData",restart:"%s%s:%s/PSIA/System/reboot",restore:"%s%s:%s/PSIA/System/factoryReset?mode=%s",startUpgrade:{upgrade:"%s%s:%s/PSIA/System/updateFirmware",status:"%s%s:%s/PSIA/Custom/SelfExt/upgradeStatus"},set3DZoom:"%s%s:%s/PSIA/Custom/SelfExt/PTZ/channels/%s/Set3DZoom",deviceCapture:{channels:"%s%s:%s/PSIA/Streaming/channels/%s/picture"},systemCapabilities:"%s%s:%s/PSIA/System/capabilities"},K.prototype.login=function(e,n,r,s){var o=2==s.protocol?"https://":"http://",i=x(this.CGI.login,o,e,n),a=new O,c={type:"GET",url:i,auth:r,success:null,error:null};f.extend(c,s),f.extend(c,{success:function(e){"200"==t.$XML(e).find("statusValue").eq(0).text()?s.success&&s.success(e):s.error&&s.error(401,e)},error:function(e,t){s.error&&s.error(e,t)}}),a.setRequestParam(c),a.submitRequest()},K.prototype.getAudioInfo=function(e,t){var n=x(this.CGI.getAudioInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getDeviceInfo=function(e,n){var r=x(this.CGI.getDeviceInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"GET",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){var r=[];r.push("<DeviceInfo>"),r.push("<deviceName>"+f.escape(t.$XML(e).find("deviceName").eq(0).text())+"</deviceName>"),r.push("<deviceID>"+t.$XML(e).find("deviceID").eq(0).text()+"</deviceID>"),r.push("<deviceType>"+t.$XML(e).find("deviceDescription").eq(0).text()+"</deviceType>"),r.push("<model>"+t.$XML(e).find("model").eq(0).text()+"</model>"),r.push("<serialNumber>"+t.$XML(e).find("serialNumber").eq(0).text()+"</serialNumber>"),r.push("<macAddress>"+t.$XML(e).find("macAddress").eq(0).text()+"</macAddress>"),r.push("<firmwareVersion>"+t.$XML(e).find("firmwareVersion").eq(0).text()+"</firmwareVersion>"),r.push("<firmwareReleasedDate>"+t.$XML(e).find("firmwareReleasedDate").eq(0).text()+"</firmwareReleasedDate>"),r.push("<encoderVersion>"+t.$XML(e).find("logicVersion").eq(0).text()+"</encoderVersion>"),r.push("<encoderReleasedDate>"+t.$XML(e).find("logicReleasedDate").eq(0).text()+"</encoderReleasedDate>"),r.push("</DeviceInfo>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},K.prototype.getSystemCapa=function(e,t){var n=x(this.CGI.systemCapabilities,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",async:!1,url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getAnalogChannelInfo=function(e,n){var r=x(this.CGI.getAnalogChannelInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"GET",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){var r=[];r.push("<VideoInputChannelList>");for(var s=t.$XML(e).find("VideoInputChannel",!0),o=0,i=s.length;o<i;o++){var a=s[o];r.push("<VideoInputChannel>"),r.push("<id>"+t.$XML(a).find("id").eq(0).text()+"</id>"),r.push("<inputPort>"+t.$XML(a).find("inputPort").eq(0).text()+"</inputPort>"),r.push("<name>"+f.escape(t.$XML(a).find("name").eq(0).text())+"</name>"),r.push("<videoFormat>"+t.$XML(a).find("videoFormat").eq(0).text()+"</videoFormat>"),r.push("</VideoInputChannel>")}r.push("</VideoInputChannelList>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},K.prototype.getDigitalChannel=function(e,n){var r=x(this.CGI.getDigitalChannel,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"GET",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){var r=[];r.push("<InputProxyChannelList>");for(var s=t.$XML(e).find("DynVideoInputChannel",!0),o=0,i=s.length;o<i;o++){var a=s[o];r.push("<InputProxyChannel>"),r.push("<id>"+t.$XML(a).find("id").eq(0).text()+"</id>"),r.push("<name>"+f.escape(t.$XML(a).find("name").eq(0).text())+"</name>"),r.push("</InputProxyChannel>")}r.push("</InputProxyChannelList>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},K.prototype.getDigitalChannelInfo=function(e,n){var r=null,s={};if(this.getDigitalChannel(e,{async:!1,success:function(e){r=e;for(var n=t.$XML(r).find("InputProxyChannel",!0),o=0,i=n.length;o<i;o++){var a=n[o],c=t.$XML(a).find("id").eq(0).text(),u=t.$XML(a).find("name").eq(0).text();s[c]=u}},error:function(e,t){n.error&&n.error(e,t)}}),null!==r){var o=x(this.CGI.getDigitalChannelInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),i=new O,a={type:"GET",url:o,auth:e.szAuth,success:null,error:null};f.extend(a,n),f.extend(a,{success:function(e){var r=[];r.push("<InputProxyChannelStatusList>");for(var o=t.$XML(e).find("DynVideoInputChannelStatus",!0),i=0,a=o.length;i<a;i++){var c=o[i],u=t.$XML(c).find("id").eq(0).text();r.push("<InputProxyChannelStatus>"),r.push("<id>"+u+"</id>"),r.push("<sourceInputPortDescriptor>"),r.push("<proxyProtocol>"+t.$XML(c).find("adminProtocol").eq(0).text()+"</proxyProtocol>"),r.push("<addressingFormatType>"+t.$XML(c).find("addressingFormatType").eq(0).text()+"</addressingFormatType>"),r.push("<ipAddress>"+t.$XML(c).find("ipAddress").eq(0).text()+"</ipAddress>"),r.push("<managePortNo>"+t.$XML(c).find("adminPortNo").eq(0).text()+"</managePortNo>"),r.push("<srcInputPort>"+t.$XML(c).find("srcInputPort").eq(0).text()+"</srcInputPort>"),r.push("<userName>"+f.escape(t.$XML(c).find("userName").eq(0).text())+"</userName>"),r.push("<streamType>"+t.$XML(c).find("streamType").eq(0).text()+"</streamType>"),r.push("<online>"+t.$XML(c).find("online").eq(0).text()+"</online>"),r.push("<name>"+f.escape(s[u])+"</name>"),r.push("</sourceInputPortDescriptor>"),r.push("</InputProxyChannelStatus>")}r.push("</InputProxyChannelStatusList>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),i.setRequestParam(a),i.submitRequest()}},K.prototype.getZeroChannelInfo=function(e,t){var n=x(this.CGI.getZeroChannelInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getPPPoEStatus=function(e,t){var n=x(this.CGI.getPPPoEStatus,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getUPnPPortStatus=function(e,t){var n=x(this.CGI.getUPnPPortStatus,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getNetworkBond=function(e,t){var n=x(this.CGI.getNetworkBond,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getNetworkInterface=function(e,t){var n=x(this.CGI.getNetworkInterface,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getPortInfo=function(e,n){var r=x(this.CGI.getPortInfo,e.szHttpProtocol,e.szIP,e.iCGIPort),s=new O,o={type:"GET",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(r){var s=[];s.push("<AdminAccessProtocolList>");for(var o=t.$XML(r).find("AdminAccessProtocol",!0),i=0,a=o.length;i<a;i++)o[i],s.push("<AdminAccessProtocol>"),s.push("<id>"+t.$XML(r).find("id").eq(0).text()+"</id>"),s.push("<enabled>"+t.$XML(r).find("enabled").eq(0).text()+"</enabled>"),s.push("<protocol>"+t.$XML(r).find("protocol").eq(0).text().toUpperCase()+"</protocol>"),s.push("<portNo>"+t.$XML(r).find("portNo").eq(0).text()+"</portNo>"),s.push("</AdminAccessProtocol>");P.getStreamChannels(e,{async:!1,success:function(r){if(0<t.$XML(r).find("rtspPortNo",!0).length){var o=parseInt(t.$XML(r).find("rtspPortNo").eq(0).text(),10);s.push("<AdminAccessProtocol>"),s.push("<id>4</id>"),s.push("<enabled>true</enabled>"),s.push("<protocol>RTSP</protocol>"),s.push("<portNo>"+o+"</portNo>"),s.push("</AdminAccessProtocol>"),s.push("</AdminAccessProtocolList>");var i=f.loadXML(s.join(""));n.success&&n.success(i)}else P.getStreamDynChannels(e,{async:!1,success:function(e){if(0<t.$XML(e).find("rtspPortNo",!0).length){var r=parseInt(t.$XML(e).find("rtspPortNo").eq(0).text(),10);s.push("<AdminAccessProtocol>"),s.push("<id>4</id>"),s.push("<enabled>true</enabled>"),s.push("<protocol>RTSP</protocol>"),s.push("<portNo>"+r+"</portNo>"),s.push("</AdminAccessProtocol>"),s.push("</AdminAccessProtocolList>");var o=f.loadXML(s.join(""));n.success&&n.success(o)}},error:function(){n.error&&n.error()}})},error:function(){n.error&&n.error()}})},error:function(){var r=[];r.push("<AdminAccessProtocolList>"),P.getStreamChannels(e,{async:!1,success:function(s){if(0<t.$XML(s).find("rtspPortNo",!0).length){var o=parseInt(t.$XML(s).find("rtspPortNo").eq(0).text(),10);r.push("<AdminAccessProtocol>"),r.push("<id>4</id>"),r.push("<enabled>true</enabled>"),r.push("<protocol>RTSP</protocol>"),r.push("<portNo>"+o+"</portNo>"),r.push("</AdminAccessProtocol>"),r.push("</AdminAccessProtocolList>");var i=f.loadXML(r.join(""));n.success&&n.success(i)}else P.getStreamDynChannels(e,{async:!1,success:function(e){if(0<t.$XML(e).find("rtspPortNo",!0).length){var s=parseInt(t.$XML(e).find("rtspPortNo").eq(0).text(),10);r.push("<AdminAccessProtocol>"),r.push("<id>4</id>"),r.push("<enabled>true</enabled>"),r.push("<protocol>RTSP</protocol>"),r.push("<portNo>"+s+"</portNo>"),r.push("</AdminAccessProtocol>"),r.push("</AdminAccessProtocolList>");var o=f.loadXML(r.join(""));n.success&&n.success(o)}},error:function(){n.error&&n.error()}})},error:function(){n.error&&n.error()}})}}),s.setRequestParam(o),s.submitRequest()},K.prototype.getStreamChannels=function(e,t){if(0!=e.iAnalogChannelNum)var n=x(this.CGI.getStreamChannels.analog,e.szHttpProtocol,e.szIP,e.iCGIPort);else n=x(this.CGI.getStreamChannels.digital,e.szHttpProtocol,e.szIP,e.iCGIPort);var r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.getStreamDynChannels=function(e,t){var n=x(this.CGI.getStreamDynChannels,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"GET",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.startRealPlay=function(e,t){var n=100*t.iChannelID+t.iStreamType,r="",s=e.szIP;"rtsp://"===t.urlProtocol&&(s=D(s)),r=t.bZeroChannel?x(t.cgi.zeroChannels,t.urlProtocol,s,t.iPort,n):x(t.cgi.channels,t.urlProtocol,s,t.iPort,n);var o=a.HWP_Play(r,e.szAuth,t.iWndIndex,"","");if(0==o){var i=new j;i.iIndex=t.iWndIndex,i.szIP=e.szIP,i.iCGIPort=e.iCGIPort,i.szDeviceIdentify=e.szDeviceIdentify,i.iChannelID=t.iChannelID,i.iPlayStatus=1,d.push(i)}return o},K.prototype.startVoiceTalk=function(e,t){var n=x(this.CGI.startVoiceTalk.open,e.szHttpProtocol,e.szIP,e.iCGIPort,t),r=x(this.CGI.startVoiceTalk.close,e.szHttpProtocol,e.szIP,e.iCGIPort,t),s=x(this.CGI.startVoiceTalk.audioData,e.szHttpProtocol,e.szIP,e.iCGIPort,t);return a.HWP_StartVoiceTalkEx(n,r,s,e.szAuth,e.iAudioTypeoDeviceInfo.m_iAudioBitRate,e.m_iAudioSamplingRate)},K.prototype.ptzAutoControl=function(e,t,n,r){var s=n.iChannelID,o="",i="";if(r.iPTZSpeed=r.iPTZSpeed<7?15*r.iPTZSpeed:100,t&&(r.iPTZSpeed=0),e.szDeviceType!=y)o=x(this.CGI.ptzAutoControl,e.szHttpProtocol,e.szIP,e.iCGIPort,s),i="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+r.iPTZSpeed+"</pan><tilt>0</tilt></PTZData>";else{var a=99;t&&(a=96),o=x(this.CGI.goPreset,e.szHttpProtocol,e.szIP,e.iCGIPort,s,a)}var c=new O,u={type:"PUT",url:o,async:!1,auth:e.szAuth,data:i,success:null,error:null},l=this;f.extend(u,r),f.extend(u,{success:function(e){n.bPTZAuto=!n.bPTZAuto,r.success&&r.success(e)},error:function(t,s){if(e.szDeviceType!=y){o=x(l.CGI.ptzControl,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID);var a=new O,c={type:"PUT",url:o,async:!1,auth:e.szAuth,data:i,success:null,error:null};f.extend(c,r),a.setRequestParam(c),a.submitRequest()}else r.error&&r.error(t,s)}}),c.setRequestParam(u),c.submitRequest()},K.prototype.ptzControl=function(e,t,n,r){var s;n.iChannelID,n.bPTZAuto&&this.ptzAutoControl(e,!0,n,{iPTZSpeed:0}),r.iPTZSpeed=t?0:r.iPTZSpeed<7?15*r.iPTZSpeed:100;var o=[{},{pan:0,tilt:r.iPTZSpeed},{pan:0,tilt:-r.iPTZSpeed},{pan:-r.iPTZSpeed,tilt:0},{pan:r.iPTZSpeed,tilt:0},{pan:-r.iPTZSpeed,tilt:r.iPTZSpeed},{pan:-r.iPTZSpeed,tilt:-r.iPTZSpeed},{pan:r.iPTZSpeed,tilt:r.iPTZSpeed},{pan:r.iPTZSpeed,tilt:-r.iPTZSpeed},{},{speed:r.iPTZSpeed},{speed:-r.iPTZSpeed},{speed:r.iPTZSpeed},{speed:-r.iPTZSpeed},{speed:r.iPTZSpeed},{speed:-r.iPTZSpeed}],i="",a={};switch(r.iPTZIndex){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:a=this.CGI.ptzControl,i="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+o[r.iPTZIndex].pan+"</pan><tilt>"+o[r.iPTZIndex].tilt+"</tilt></PTZData>";break;case 10:case 11:a=this.CGI.ptzControl,i="<?xml version='1.0' encoding='UTF-8'?><PTZData><zoom>"+o[r.iPTZIndex].speed+"</zoom></PTZData>";break;case 12:case 13:a=this.CGI.ptzFocus,i="<?xml version='1.0' encoding='UTF-8'?><FocusData><focus>"+o[r.iPTZIndex].speed+"</focus></FocusData>";break;case 14:case 15:a=this.CGI.ptzIris,i="<?xml version='1.0' encoding='UTF-8'?><IrisData><iris>"+o[r.iPTZIndex].speed+"</iris></IrisData>";break;default:return void(r.error&&r.error())}s=x(a,e.szHttpProtocol,e.szIP,e.iCGIPort,n.iChannelID);var c=new O,u={type:"PUT",url:s,async:!1,auth:e.szAuth,data:i,success:null,error:null};f.extend(u,r),f.extend(u,{success:function(e){r.success&&r.success(e)},error:function(e,t){r.error&&r.error(e,t)}}),c.setRequestParam(u),c.submitRequest()},K.prototype.setPreset=function(e,t,n){t.iChannelID;var r,s="";r=x(this.CGI.setPreset,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID,n.iPresetID),s="<?xml version='1.0' encoding='UTF-8'?>",s+="<PTZPreset>",s+="<id>"+n.iPresetID+"</id>",e.szDeviceType!=y&&(s+="<presetName>Preset"+n.iPresetID+"</presetName>"),s+="</PTZPreset>";var o=new O,i={type:"PUT",url:r,auth:e.szAuth,data:s,success:null,error:null};f.extend(i,n),f.extend(i,{success:function(e){n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),o.setRequestParam(i),o.submitRequest()},K.prototype.goPreset=function(e,t,n){var r;t.iChannelID,r=x(this.CGI.goPreset,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID,n.iPresetID);var s=new O,o={type:"PUT",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},K.prototype.recordSearch=function(e,n){var r,s,o=n.iChannelID,i=n.iStreamType,a=n.szStartTime.replace(" ","T")+"Z",c=n.szEndTime.replace(" ","T")+"Z";r=x(this.CGI.recordSearch,e.szHttpProtocol,e.szIP,e.iCGIPort),s="<?xml version='1.0' encoding='UTF-8'?><CMSearchDescription><searchID>"+new ne+"</searchID><trackList><trackID>"+(100*o+i)+"</trackID></trackList><timeSpanList><timeSpan><startTime>"+a+"</startTime><endTime>"+c+"</endTime></timeSpan></timeSpanList><maxResults>40</maxResults><searchResultPostion>"+n.iSearchPos+"</searchResultPostion><metadataList><metadataDescriptor>//metadata.psia.org/VideoMotion</metadataDescriptor></metadataList></CMSearchDescription>";var u=new O,l={type:"POST",url:r,auth:e.szAuth,data:s,success:null,error:null};f.extend(l,n),f.extend(l,{success:function(e){var r=[];r.push("<CMSearchResult>"),r.push("<responseStatus>"+t.$XML(e).find("responseStatus").eq(0).text()+"</responseStatus>"),r.push("<responseStatusStrg>"+t.$XML(e).find("responseStatusStrg").eq(0).text()+"</responseStatusStrg>"),r.push("<numOfMatches>"+t.$XML(e).find("numOfMatches").eq(0).text()+"</numOfMatches>"),r.push("<matchList>");for(var s=t.$XML(e).find("searchMatchItem",!0),o=0,i=s.length;o<i;o++){var a=s[o];r.push("<searchMatchItem>"),r.push("<trackID>"+t.$XML(a).find("trackID").eq(0).text()+"</trackID>"),r.push("<startTime>"+t.$XML(a).find("startTime").eq(0).text()+"</startTime>"),r.push("<endTime>"+t.$XML(a).find("endTime").eq(0).text()+"</endTime>"),r.push("<playbackURI>"+f.escape(t.$XML(a).find("playbackURI").eq(0).text())+"</playbackURI>"),r.push("<metadataDescriptor>"+t.$XML(a).find("metadataDescriptor").eq(0).text().split("/")[1]+"</metadataDescriptor>"),r.push("</searchMatchItem>")}r.push("</matchList>"),r.push("</CMSearchResult>"),e=f.loadXML(r.join("")),n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),u.setRequestParam(l),u.submitRequest()},K.prototype.startPlayback=function(e,t){var n=t.iWndIndex,r=t.szStartTime,s=t.szEndTime,o=e.szIP;"rtsp://"===t.urlProtocol&&(o=D(o));var i=x(t.cgi,t.urlProtocol,o,t.iPort,t.iChannelID,r,s),c=a.HWP_Play(i,e.szAuth,n,r,s);if(0==c){var u=new j;u.iIndex=n,u.szIP=e.szIP,u.iCGIPort=e.iCGIPort,u.szDeviceIdentify=e.szDeviceIdentify,u.iChannelID=t.iChannelID,u.iPlayStatus=2,d.push(u)}return c},K.prototype.reversePlayback=function(e,t){var n=t.iWndIndex,r=t.szStartTime,s=t.szEndTime,o=e.szIP;"rtsp://"===t.urlProtocol&&(o=D(o));var i=x(t.cgi,t.urlProtocol,o,t.iPort,t.iChannelID,r,s),c=a.HWP_ReversePlay(i,e.szAuth,n,r,s);if(0==c){var u=new j;u.iIndex=n,u.szIP=e.szIP,u.iCGIPort=e.iCGIPort,u.szDeviceIdentify=e.szDeviceIdentify,u.iChannelID=t.iChannelID,u.iPlayStatus=5,d.push(u)}return c},K.prototype.startDownloadRecord=function(e,t){var n=x(this.CGI.startDownloadRecord,e.szHttpProtocol,e.szIP,e.iCGIPort),r="<?xml version='1.0' encoding='UTF-8'?><downloadRequest><playbackURI> "+f.escape(t.szPlaybackURI)+"</playbackURI></downloadRequest>";return a.HWP_StartDownload(n,e.szAuth,t.szFileName,r,t.bDateDir)},K.prototype.exportDeviceConfig=function(e){var t=x(this.CGI.downloaddeviceConfig,e.szHttpProtocol,e.szIP,e.iCGIPort);return k()?-1:a.HWP_ExportDeviceConfig(t,e.szAuth,"",0)},K.prototype.importDeviceConfig=function(e,t){var n=x(this.CGI.uploaddeviceConfig,e.szHttpProtocol,e.szIP,e.iCGIPort);return a.HWP_ImportDeviceConfig(n,e.szAuth,t.szFileName,0)},K.prototype.restart=function(e,t){var n=x(this.CGI.restart,e.szHttpProtocol,e.szIP,e.iCGIPort),r=new O,s={type:"PUT",url:n,auth:e.szAuth,success:null,error:null};f.extend(s,t),f.extend(s,{success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(e,n)}}),r.setRequestParam(s),r.submitRequest()},K.prototype.restore=function(e,t,n){var r=x(this.CGI.restore,e.szHttpProtocol,e.szIP,e.iCGIPort,t),s=new O,o={type:"PUT",url:r,auth:e.szAuth,success:null,error:null};f.extend(o,n),f.extend(o,{success:function(e){n.success&&n.success(e)},error:function(e,t){n.error&&n.error(e,t)}}),s.setRequestParam(o),s.submitRequest()},K.prototype.startUpgrade=function(e,t){var n=x(this.CGI.startUpgrade.upgrade,e.szHttpProtocol,e.szIP,e.iCGIPort),r=x(this.CGI.startUpgrade.status,e.szHttpProtocol,e.szIP,e.iCGIPort);return a.HWP_StartUpgrade(n,r,e.szAuth,t.szFileName)},K.prototype.set3DZoom=function(e,t,n,r){var s=x(this.CGI.set3DZoom,e.szHttpProtocol,e.szIP,e.iCGIPort,t.iChannelID),o=new O,i={type:"PUT",url:s,data:n,auth:e.szAuth,success:null,error:null};f.extend(i,r),f.extend(i,{success:function(e){r.success&&r.success(e)},error:function(e,t){r.error&&r.error(e,t)}}),o.setRequestParam(i),o.submitRequest()},K.prototype.deviceCapturePic=function(e,t,n,r){t=100*t+1;var s=x(this.CGI.deviceCapture.channels,e.szHttpProtocol,e.szIP,e.iCGIPort,t),o=[];return f.isInt(r.iResolutionWidth)&&o.push("videoResolutionWidth="+r.iResolutionWidth),f.isInt(r.iResolutionHeight)&&o.push("videoResolutionHeight="+r.iResolutionHeight),0<o.length&&(s+="?"+o.join("&")),a.HWP_DeviceCapturePic(s,e.szAuth,n,r.bDateDir)};var Y,Q,ee=function(){};ee.prototype._alert=function(e){o.bDebugMode},Y=this,(Q=function(e){this.elems=[],this.length=0,this.length=this.elems.push(e)}).prototype.find=function(e,t){var n=this.elems[this.length-1]?this.elems[this.length-1].getElementsByTagName(e):[];return this.length=this.elems.push(n),t?n:this},Q.prototype.eq=function(e,t){var n=this.elems[this.length-1].length,r=null;return 0<n&&e<n&&(r=this.elems[this.length-1][e]),this.length=this.elems.push(r),t?r:this},Q.prototype.text=function(e){return this.elems[this.length-1]?e?void(window.DOMParser?this.elems[this.length-1].textContent=e:this.elems[this.length-1].text=e):window.DOMParser?this.elems[this.length-1].textContent:this.elems[this.length-1].text:""},Q.prototype.attr=function(e){if(this.elems[this.length-1]){var t=this.elems[this.length-1].attributes.getNamedItem(e);return t?t.value:""}},Y.$XML=function(e){return new Q(e)};var te=function(){};function ne(){this.id=this.createUUID()}te.prototype.extend=function(){for(var e,t=arguments[0]||{},n=1,r=arguments.length;n<r;n++)if(null!=(e=arguments[n]))for(var s in e){t[s];var o=e[s];t!==o&&("object"==typeof o?t[s]=this.extend({},o):void 0!==o&&(t[s]=o))}return t},te.prototype.browser=function(){var e=navigator.userAgent.toLowerCase(),t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(safari)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||/(trident.*rv:)([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(e)||["unknow","0"];0<t.length&&-1<t[1].indexOf("trident")&&(t[1]="msie");var n={};return n[t[1]]=!0,n.version=t[2],n},te.prototype.loadXML=function(e){if(null==e||""==e)return null;var t=null;return window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e)),t},te.prototype.toXMLStr=function(e){var t="";try{t=(new XMLSerializer).serializeToString(e)}catch(J){try{t=e.xml}catch(J){return""}}return-1==t.indexOf("<?xml")&&(t="<?xml version='1.0' encoding='utf-8'?>"+t),t},te.prototype.escape=function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):e},te.prototype.encodePwd=function(e,t,n){var r="";if(n)for(r=f.sha256(t.userName+t.salt+e),r=f.sha256(r+t.challenge),s=2;s<t.iIterate;s++)r=f.sha256(r);else{r=f.sha256(e)+t.challenge;for(var s=1;s<t.iIterate;s++)r=f.sha256(r)}return r},te.prototype.dateFormat=function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t},te.prototype.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,s,o,i,a,c="",u=0;for(e=te.prototype.Base64._utf8_encode(e);u<e.length;)s=(t=e.charCodeAt(u++))>>2,o=(3&t)<<4|(n=e.charCodeAt(u++))>>4,i=(15&n)<<2|(r=e.charCodeAt(u++))>>6,a=63&r,isNaN(n)?i=a=64:isNaN(r)&&(a=64),c=c+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(i)+this._keyStr.charAt(a);return c},decode:function(e){var t,n,r,s,o,i,a="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(s=this._keyStr.indexOf(e.charAt(c++)))>>4,n=(15&s)<<4|(o=this._keyStr.indexOf(e.charAt(c++)))>>2,r=(3&o)<<6|(i=this._keyStr.indexOf(e.charAt(c++))),a+=String.fromCharCode(t),64!=o&&(a+=String.fromCharCode(n)),64!=i&&(a+=String.fromCharCode(r));return te.prototype.Base64._utf8_decode(a)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):191<r&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t}},te.prototype.createEventScript=function(e,t,n){var r=document.createElement("script");r.htmlFor=e,r.event=t,r.innerHTML=n,document.body.parentNode.appendChild(r)},te.prototype.isInt=function(e){return/^\d+$/.test(e)},te.prototype.getDirName=function(){var e="";if(""!==o.szBasePath)e=o.szBasePath;else{var t=/[^?#]*\//,n=document.getElementById("videonode");if(n)e=n.src.match(t)[0];else{for(var r=document.scripts,s=0,i=r.length;s<i;s++)if(-1<r[s].src.indexOf("webVideoCtrl.js")){n=r[s];break}n&&(e=n.src.match(t)[0])}}return e},te.prototype.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.onload=function(){t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)},te.prototype.encodeString=function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},te.prototype.getIrreversibleKey=function(e,t){var n=e;if(oSecurityCap.oIrreversibleEncrypt.bSupport){var r=oSecurityCap.oIrreversibleEncrypt.salt;return f.sha256(t+r+e)}return n},te.prototype.strToAESKey=function(e,t){var n="";if(0<oSecurityCap.iKeyIterateNum){n=f.sha256(f.getIrreversibleKey(e,t)+"AaBbCcDd1234!@#$");for(var r=1;r<oSecurityCap.iKeyIterateNum;r++)n=f.sha256(n)}return n&&n.substring(0,32)},te.prototype.exportPasswordDeviceConfig=function(e,t){var n=MD5((new Date).getTime().toString());return e+"?secretkey="+f.encodeAES(f.Base64.encode(f.encodeString(t)),szAESKey,n)+"&security=1&iv="+n},te.prototype.encodeAES=function(e,t,n,r){var s="";if("ecb"===r)for(var o=e.length,i=0;0<o;)s+=16<o?aes_encrypt(e.substring(i,i+16),t,!0):aes_encrypt(e.substring(i),t,!0),o-=16,i+=16;else{void 0===n&&(n="6cd9616beb39d4034fdebe107df9a399");var a=CryptoJS.enc.Hex.parse(t),c=CryptoJS.enc.Hex.parse(n);s=CryptoJS.AES.encrypt(e,a,{mode:CryptoJS.mode.CBC,iv:c,padding:CryptoJS.pad.Pkcs7}).ciphertext.toString()}return s},te.prototype.sha256=function(e){function t(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function n(e,t){return e>>>t|e<<32-t}return function(e){for(var t="",n=0;n<4*e.length;n++)t+="0123456789abcdef".charAt(e[n>>2]>>8*(3-n%4)+4&15)+"0123456789abcdef".charAt(e[n>>2]>>8*(3-n%4)&15);return t}(function(e,r){var s,o,i,a,c,u,l,d,p,h,P,f,I=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],m=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],S=Array(64);for(e[r>>5]|=128<<24-r%32,e[15+(r+64>>9<<4)]=r,p=0;p<e.length;p+=16){for(s=m[0],o=m[1],i=m[2],a=m[3],c=m[4],u=m[5],l=m[6],d=m[7],h=0;h<64;h++)S[h]=h<16?e[h+p]:t(t(t(n(S[h-2],17)^n(S[h-2],19)^S[h-2]>>>10,S[h-7]),n(S[h-15],7)^n(S[h-15],18)^S[h-15]>>>3),S[h-16]),P=t(t(t(t(d,n(c,6)^n(c,11)^n(c,25)),c&u^~c&l),I[h]),S[h]),f=t(n(s,2)^n(s,13)^n(s,22),s&o^s&i^o&i),d=l,l=u,u=c,c=t(a,P),a=i,i=o,o=s,s=t(P,f);m[0]=t(s,m[0]),m[1]=t(o,m[1]),m[2]=t(i,m[2]),m[3]=t(a,m[3]),m[4]=t(c,m[4]),m[5]=t(u,m[5]),m[6]=t(l,m[6]),m[7]=t(d,m[7])}return m}(function(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t}(e)),8*e.length))},te.prototype.cookie=function(e,t,n){if(1<arguments.length&&(null===t||"object"!=typeof t)){if(n=this.extend({},n),null===t&&(n.expires=-1),"number"==typeof n.expires){var r=n.expires,s=n.expires=new Date;s.setDate(s.getDate()+r)}return document.cookie=[encodeURIComponent(e),"=",n.raw?String(t):encodeURIComponent(String(t)),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"; path=/",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}var o,i=(n=t||{}).raw?function(e){return e}:decodeURIComponent;return(o=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?i(o[1]):null},ne.prototype.valueOf=function(){return this.id},ne.prototype.toString=function(){return this.id},ne.prototype.createUUID=function(){var e=new Date(1582,10,15,0,0,0,0),t=(new Date).getTime()-e.getTime();return ne.getIntegerBits(t,0,31)+"-"+ne.getIntegerBits(t,32,47)+"-"+ne.getIntegerBits(t,48,59)+"1-"+ne.getIntegerBits(ne.rand(4095),0,7)+ne.getIntegerBits(ne.rand(4095),0,7)+"-"+(ne.getIntegerBits(ne.rand(8191),0,7)+ne.getIntegerBits(ne.rand(8191),8,15)+ne.getIntegerBits(ne.rand(8191),0,7)+ne.getIntegerBits(ne.rand(8191),8,15)+ne.getIntegerBits(ne.rand(8191),0,15))},ne.getIntegerBits=function(e,t,n){var r=ne.returnBase(e,16),s=new Array,o="",i=0;for(i=0;i<r.length;i++)s.push(r.substring(i,i+1));for(i=Math.floor(t/4);i<=Math.floor(n/4);i++)s[i]&&""!=s[i]?o+=s[i]:o+="0";return o},ne.returnBase=function(e,t){var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(e<t)var r=n[e];else{var s=""+Math.floor(e/t),o=e-s*t;r=t<=s?this.returnBase(s,t)+n[o]:n[s]+n[o]}return r},ne.rand=function(e){return Math.floor(Math.random()*e)},h=new J,P=new K,p=new ee;var re=(f=new te).dateFormat(new Date,"yyyyMMddhhmmss");return s=r="webVideoCtrl"+re,"object"!=typeof window.attachEvent&&f.browser().msie&&(f.createEventScript(r,"GetSelectWndInfo(SelectWndInfo)","GetSelectWndInfo(SelectWndInfo);"),f.createEventScript(r,"ZoomInfoCallback(szZoomInfo)","ZoomInfoCallback(szZoomInfo);"),f.createEventScript(r,"GetHttpInfo(lID, lpInfo, lReverse)","GetHttpInfo(lID, lpInfo, lReverse);"),f.createEventScript(r,"PluginEventHandler(iEventType, iParam1, iParam2)","PluginEventHandler(iEventType, iParam1, iParam2);"),f.createEventScript(r,"RemoteConfigInfo(lID)","RemoteConfigInfo(lID);"),f.createEventScript(r,"KeyBoardEventInfo(iKeyCode)","KeyBoardEventInfo(iKeyCode);")),this}(),t=window.WebVideoCtrl=e;t.version="1.1.0"}}(),"object"==typeof exports&&"undefined"!=typeof module||("function"==typeof define&&define.amd?define((function(){return WebVideoCtrl})):"function"==typeof define&&define.cmd&&define((function(e,t,n){n.exports=WebVideoCtrl})));