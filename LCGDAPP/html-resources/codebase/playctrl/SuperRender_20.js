"use strict";var vertexYUVShader=["#version 300 es","layout(location = 0) in vec4 vertexPos;","layout(location = 1) in vec2 texturePos;","out vec2 textureCoord;","void main()","{","gl_Position = vertexPos;","textureCoord = texturePos;","}"].join("\n"),fragmentYUVShader=["#version 300 es","precision highp float;","in vec2 textureCoord;","out vec4 fragColor;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","const mat4 YUV2RGB = mat4","(","1.1643828125, 0, 1.59602734375, -.87078515625,","1.1643828125, -.39176171875, -.81296875, .52959375,","1.1643828125, 2.017234375, 0, -1.081390625,","0, 0, 0, 1",");","void main(void) {","float y = texture(ySampler,  textureCoord).r;","float u = texture(uSampler,  textureCoord).r;","float v = texture(vSampler,  textureCoord).r;","fragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n"),vertexLineShader=["#version 300 es","layout(location = 0) in vec4 vertexPosLine;","void main()","{","gl_Position = vertexPosLine;","}"].join("\n"),fragmentLineShader=["#version 300 es","precision highp float;","uniform mediump float fRcom;","uniform mediump float fGcom;","uniform mediump float fBcom;","out vec4 fragColor;","void main()","{","fragColor = vec4(fRcom,fGcom,fBcom,1.0);","}"].join("\n");(function(e,t){e.SuperRender2=t()})(this,(function(){function e(e){this.canvasElement=document.getElementById(e),this.initContextGL(),this.contextGL&&(this.YUVProgram=this.initProgram(vertexYUVShader,fragmentYUVShader),this.LineProgram=this.initProgram(vertexLineShader,fragmentLineShader),this.initBuffers(),this.initTextures())}return e.prototype.initContextGL=function(){var e=this.canvasElement,t=null;try{t=e.getContext("webgl2")}catch(e){t=null}t&&"function"===typeof t.getParameter||(t=null),this.contextGL=t,console.log("WebGL2.0")},e.prototype.initProgram=function(e,t){var r=this.contextGL,i=r.createShader(r.VERTEX_SHADER);r.shaderSource(i,e),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+r.getShaderInfoLog(i));var o=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(o,t),r.compileShader(o),r.getShaderParameter(o,r.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+r.getShaderInfoLog(o));var a=r.createProgram();return r.attachShader(a,i),r.attachShader(a,o),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)||console.log("Program failed to compile: "+r.getProgramInfoLog(a)),r.deleteShader(i),r.deleteShader(o),a},e.prototype.initBuffers=function(){var e=this.contextGL,t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);var r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,16,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),this.vertexPosBuffer=t,this.texturePosBuffer=r,this.vertexLineBuffer=i},e.prototype.initTextures=function(){var e=this.contextGL,t=this.YUVProgram;e.useProgram(t);var r=this.initTexture(),i=e.getUniformLocation(t,"ySampler");e.uniform1i(i,0),this.yTextureRef=r;var o=this.initTexture(),a=e.getUniformLocation(t,"uSampler");e.uniform1i(a,1),this.uTextureRef=o;var n=this.initTexture(),f=e.getUniformLocation(t,"vSampler");e.uniform1i(f,2),this.vTextureRef=n,e.useProgram(null)},e.prototype.initTexture=function(){var e=this.contextGL,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),t},e.prototype.SR_DisplayFrameData=function(e,t,r){if(!(e<=0||t<=0)){var i=this.contextGL;if(null==r)return i.clearColor(0,0,0,0),void i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);var o=this.canvasElement;this.nWindowWidth=o.width,this.nWindowHeight=o.height;var a=this.nWindowWidth,n=this.nWindowHeight;i.clearColor(.8,.8,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.viewport(0,0,a,n),this.updateFrameData(e,t,r);var f=this.YUVProgram;i.useProgram(f);var u=this.vertexPosBuffer;i.bindBuffer(i.ARRAY_BUFFER,u);var s=i.getAttribLocation(f,"vertexPos");i.enableVertexAttribArray(s),i.vertexAttribPointer(s,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,null);var R=this.texturePosBuffer;i.bindBuffer(i.ARRAY_BUFFER,R);var l=i.getAttribLocation(f,"texturePos");i.enableVertexAttribArray(l),i.vertexAttribPointer(l,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,null),i.drawArrays(i.TRIANGLE_STRIP,0,4),i.disableVertexAttribArray(s),i.disableVertexAttribArray(l),i.useProgram(null)}},e.prototype.updateFrameData=function(e,t,r){var i=this.contextGL,o=this.yTextureRef,a=this.uTextureRef,n=this.vTextureRef,f=r,u=e*t,s=f.subarray(0,u);i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,e,t,0,i.LUMINANCE,i.UNSIGNED_BYTE,s);var R=e/2*t/2,l=f.subarray(u,u+R);i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,a),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,e/2,t/2,0,i.LUMINANCE,i.UNSIGNED_BYTE,l);var m=R,h=f.subarray(u+R,u+R+m);i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,n),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,e/2,t/2,0,i.LUMINANCE,i.UNSIGNED_BYTE,h)},e.prototype.SR_DrawLine=function(e,t,r,i){var o=this.contextGL,a=this.nWindowWidth,n=this.nWindowHeight,f=this.LineProgram;o.useProgram(f);var u=o.getUniformLocation(f,"fRcom");o.uniform1f(u,r.fR);var s=o.getUniformLocation(f,"fGcom");o.uniform1f(s,r.fG);var R=o.getUniformLocation(f,"fBcom");o.uniform1f(R,r.fB);var l=e.fX/a*2-1,m=-e.fY/n*2+1,h=t.fX/a*2-1,E=-t.fY/n*2+1,d=this.vertexLineBuffer;o.bindBuffer(o.ARRAY_BUFFER,d),o.bufferSubData(o.ARRAY_BUFFER,0,new Float32Array([l,m,h,E]));var T=o.getAttribLocation(f,"vertexPosLine");o.enableVertexAttribArray(T),o.vertexAttribPointer(T,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,null),o.drawArrays(o.LINES,0,2),o.disableVertexAttribArray(T),o.useProgram(null)},e.prototype.SR_SetDisplayRect=function(e){var t=this.contextGL,r=this.nWindowWidth,i=this.nWindowHeight,o=null;if(e&&r>0&&i>0){var a=e.left/r,n=e.top/i,f=e.right/r,u=e.bottom/i;o=new Float32Array([f,n,a,n,f,u,a,u])}else o=new Float32Array([1,0,0,0,1,1,0,1]);var s=this.texturePosBuffer;t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferSubData(t.ARRAY_BUFFER,0,o),t.bindBuffer(t.ARRAY_BUFFER,null)},e.prototype.SR_Destroy=function(){var e=this.contextGL,t=this.YUVProgram;e.deleteProgram(t);var r=this.LineProgram;e.deleteProgram(r);var i=this.vertexPosBuffer,o=this.texturePosBuffer,a=this.vertexLineBuffer;e.deleteBuffer(i),e.deleteBuffer(o),e.deleteBuffer(a);var n=this.yTextureRef,f=this.uTextureRef,u=this.vTextureRef;e.deleteTexture(n),e.deleteTexture(f),e.deleteTexture(u)},e}));